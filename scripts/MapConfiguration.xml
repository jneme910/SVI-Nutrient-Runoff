<?xml version="1.0"?>
<!-- 
The following provides a description of the MapConfiguration.xml file. It is organized 
into the following sections:
  [1] Tree Structure
  [2] General Notes
  [3] The Attribute System
  [4] Class-Specific Details


[1] Tree Structure

The MapConfiguration.xml file is composed from the following 
generalized class hierarchy ('class' and XML node 'name' are used somewhat
indiscriminantly here; when an Xml node name is defined for an array
or list element, it is shown quoted in parentheses). An asterisk indicates
that the name is a 'family name' (for example 'MapLayerGroup*' may be
'MapLayerGroupPolygon', 'MapLayerGroupLine', etc.). A plus sign indicates
that the node is defined elsewhere in the tree). The 'note #' refers to
a general note, immediately following this section.

  MapConfiguration (note 1)
  .  Settings
  .  .  PixelsPerInch
  .  .  .  int Default
  .  .  .  int Minimum
  .  .  .  int Maximum
  .  .  DefaultViewExtentName
  .  .  List<ViewExtentBase> ViewExtents (note 2)
  .  .  .  string Name
  .  .  .  double MinimumLongitude
  .  .  .  double MinimumLatitude
  .  .  .  double MaximumLongitude
  .  .  .  double MaximumLatitude
  .  .  .  List<ViewExtentBase> ViewExtents
  .  .  Zoom
  .  .  .  int MinimumZoomScale
  .  .  .  List<int> ZoomScales 'MapScale'
  .  .  double MaxAoiSize
  .  .  double MinAoiSize
  .  .  ScaleBar
  .  .  .  int MaximumFineScaleDenominator
  .  .  List<string> MapModes  ('Name')
  .  .  MapServerBaseDefinition
  .  .  .  string BoilerplateText
  .  .  .  List<MapserverProjectionDefinition> ProjectionDefinitions
  .  .  .  .  int Srid
  .  .  .  .  string Definition
  .  .  .  .  string Comment
  .  .  List<NameAndValueStringPair> DiagnosticRuntimeAttributes
  .  List<MapAttribute> MapAttributes (note 3)
  .  .  MapAttributeType AttributeType 
  .  .  string StringValue (note 5)
  .  .  string Name
  .  .  bool IsEditable
  .  .  string MinValue (note 4)
  .  .  string MaxValue (note 4)
  .  .  List<NameAndValueStringPair> ChoiceList (note 5)
  .  .  .  string Name
  .  .  .  string Value
  .  List<LegendCategory> LegendCategories
  .  .  string Name
  .  .  bool AreLayerGroupsMutuallyExclusive
  .  .  List<MapAttribute> MapAttributes+ (note 3)
  .  .  List<MapLayerGroup> MapLayerGroups (note 6)
  .  .  .  string Name
  .  .  .  LayerType MapLayerType (note 10).
  .  .  .  int MapLayerGroupId
  .  .  .  bool HasLayerDescriptions
	.  .  .  bool CanUseClientSideImage
  .  .  .  bool IsIdentifiable
  .  .  .  int MinScaleDenom
  .  .  .  int MaxScaleDenom
  .  .  .  string LayerGroupWriterClassName
  .  .  .  List<MapAttribute> MapAttributes+ (note 3)
  .  .  .  List<MapMode> MapModes
  .  .  .  .  string Name
  .  .  .  .  bool VisibleByDefault
  .  .  .  List<Layer> MapLayers
  .  .  .  .  string Name
  .  .  .  .  int DrawOrder
  .  .  .  .  int MinScaleDenom
  .  .  .  .  int MaxScaleDenom
  .  .  .  .  int LabelMinScaleDenom
  .  .  .  .  int LabelMaxScaleDenom
  .  .  .  .  LayerIdentify Identify
  .  .  .  .  .  string ConnectionKey
  .  .  .  .  .  string GeometryColumn
  .  .  .  .  .  int SRID
  .  .  .  .  .  string Source
  .  .  .  .  .  string StatementRemainder
  .  .  .  .  .  List<LayerIdentifyAttribute> IdentifyAttributes
  .  .  .  .  .  .  string ColumnName
  .  .  .  .  .  .  string DisplayName
  .  .  .  .  .  .  bool DisplayEmptyValue
  .  .  .  .  List<LayerDescriptionGroup> MapLayerDescriptionGroups
  .  .  .  .  .  string Name
  .  .  .  .  .  List<LayerDescription> MapLayerDescriptions
  .  .  .  .  .  .  string Name
  .  .  .  .  .  .  string Value
  .  .  .  .  string MapServerLayerTemplateText
  .  .  .  .  LayerAvailableTestType AvailablilityTestType
  .  .  .  .  bool SkipIfUnavailable
  .  .  .  .  string AvailablilityTestString
  .  .  .  MapLegendBase Legend (note 7)
  .  .  .  .  List<FilenameTextAttributenameComparisonvalueTuple> MapLegendImages (note 8)
  .  .  .  .  .  string FileName
  .  .  .  .  .  string Text
  .  .  .  .  .  string AttributeName
  .  .  .  .  .  string ComparisonValue
  .  .  .  .  string BoundaryColorMapAttributeName (note 9)
  .  .  .  .  string BoundaryColorValue            (note 9)
  .  .  .  .  string FillColorMapAttributeName     (note 9)
  .  .  .  .  string FillColorValue                (note 9)
  .  .  .  .  string OpacityMapAttributeName       (note 9)
  .  .  .  .  string OpacityValue                  (note 9)
  .  .  .  .  string ImageBackgroundFillColorMapAttributeName (note 9)
  .  .  .  .  string ImageBackgroundFillColorValue            (note 9)
  .  .  .  .  string ImageBackgroundOpacityMapAttributeName   (note 9)
  .  .  .  .  string ImageBackgroundOpacityValue              (note 9)
  .  .  .  .  string Text                          (note 9)
  .  .  .  .  bool IsDynamic                       (note 9)


[2] General Notes

1. All classes are derived from MapConfigurationBase. 
   Only those classes (or collection of class oblects) that may appear in 
  the MapConfiguration.xml file are shown here. A few secondary classes
  that are passed through the WCF mechanism (most notably the
  'Dictionary<string, MapAttribute> MapAttributeDictionary' are not shown.
2. A ViewExtentBase is realized as a ViewExtent, or as a ViewExtentGroup.
  A ViewExtentGroup contains a list of ViewExtentBase as well as a Name;
  A ViewExtent contains a Name as well as min/max latitude/longitudes.
3. 'Attributes',  defined further under 'The attribute system' below, are
  normally associated with 'layer groups'. Individual attributes may be 
  defined at nodes closer to the MapConfiguration root, in which case their
  definitions will be propagated downward to all child layer groups.
4. MinValue and MaxValue are used with MapAttributeType.ColorRamp,
  MapAttributeType.ClampedDouble and MapAttributeType.ClampedInteger. 
  Retrieval should be through ColorValue, MinColor, MaxColor,
  DoubleValue, MinDouble, MaxDouble, IntegerValue, MinInteger and MaxInteger
  as appropriate.
5. ChoiceList is only used for MapAttributeType.EnumeratedChoice.
  The StringValue is specified for all attribute types
6. The MapLayerGroupBase is instantiated by one of the following:
  MapLayerGroupPolygon, MapLayerGroupLine, MapLayerGroupPoint,
  MapLayerGroupOrthophoto, or MapLayerGroupGeneral.
7. The MapLegendBase is realized as one of the following:
  MapLegendNone, MapLegendImage, or MapLegendColor.
8. The MapLegendImages list is only relevant for a MapLegendImage.
9. BoundaryColorMapAttributeName, BoundaryColorValue,
  FillColorMapAttributeName, FillColorValue, OpacityMapAttributeName 
  and OpacityValue and Text are valid with a MapLegendColor:
	 optional:
	   string Text { get; set; }
	   mutually exclusive:
		string BoundaryColorMapAttributeName { get; set; }
		string BoundaryColorValue { get; set; }
	   mutually exclusive:
		string FillColorMapAttributeName { get; set; }
		string FillColorValue { get; set; }
	   mutually exclusive:
		string OpacityMapAttributeName { get; set; }
		int OpacityValue { get; set; }
  ImageBackgroundFillColorMapAttributeName, ImageBackgroundFillColorValue,
  ImageBackgroundOpacityMapAttributeName and ImageBackgroundOpacityValue
  are valid with MapLegendImage:
	 optional:
	   mutually exclusive:
		string ImageBackgroundFillColorMapAttributeName { get; set; }
		string ImageBackgroundFillColorValue { get; set; }
	   mutually exclusive:
		string ImageBackgroundOpacityMapAttributeName { get; set; }
		string ImageBackgroundOpacityValue { get; set; }
	The BoundaryColorValue and FillColorValue, if used, must
	specify a color (i.e., a string literal that starts with a hash 
	mark and contains a six-figure hex value, such as '#33ff45').
	Note that the BoundaryColorMapAttributeNameOrColor and
	FillColorMapAttributeNameOrColor may each independantly specify 
	an appropriate attribute name or specify a color (i.e.,
	a string literal that starts with a hash mark, such as
	'#33ff45'). Opacity defaults to 100.
	IsDynamic is present with all legends and indicates that legend
	content is determined at run time; it is up to the application
	to manage this generation and image painting.
10. The LayerType is one of Line, Point, Polygon, Orthophoto or General.


[3] The Attribute System

'Attributes' are variables, placeholders for values in the configuration
file. They fall into one of four categories:
 1. 'map layer group' defined attributes (the 'normal' attributes),
 2. attributes derived from the current layer group (the 'layer group'
   attributes: the layer name, whether labels are visible),
 3. attributes derived from the Web.config file (the 'configuration' 
   attributes, such as connection strings), or 
 4. attributes tied to the map request as a whole (the 'map request'
   attributes, such as the coordinate extent or raster dimensions
   and the nominal scale denominator).

The 'map layer group' attributes are defined for a map layer group; they 
may also be defined 'higher up' in a legend category or in the root of the 
MapConfiguration. These are used in part for specifying editable components
of the UI's legend. In the simplest form they are pairs of strings, a name 
and a value. Within the tree they may be individually represented by 
'MapAttribute*' class family members that place additional constraints upon 
the value (such as whether the UI's user may edit the value through the 
legend, or the permissible domain and range of the value, such as a boolean, 
constrained to true or false). These attribute names must not contain left 
or right braces, the tilde, newline, return, or tab. They may not start with 
a dollar sign, caret or ampersand.

The various categories are shown in the map file template and elsewhere
as names, surrounded by braces, with some distinct initial characters
when not 'normal'.

 1. Normal attributes are specified by braces around the name, such as:
   {Opacity}
 2. Layer group attributes are specified by braces with a leading tilde
   and ampersand, such as:
	{~@LayerName}
 3. Configuration attributes, denoted by a leading tilde and dollar sign,
   are named 'ConnectionString...', 'WebConfigSetting...' or 'Projection.###'
   such as
	{~$ConnectionString.BafConnectionString}
	{~$WebConfigSetting.DoLogDebugMessages}
	{~$Projection.3857}

 4. Map Request settings are denoted by a leading tilde and caret,
   such as
	{~^RasterSizeX}

The predefined Layer group attributes set consists of:

  1. The '{~@LayerName}' is the name of the current map layer.
  2. {~@AreLabelsVisible} (True/False) specifies whether labels are visible
	at the current scale.

Sample configuration attributes:

  '{~$ConnectionString.BafConnectionString}',
  '{~$ConnectionString.NrcsSpatialMartConnectionString}', and 
  '{~$ConnectionString.SdmConnectionString}'

  The web-configuration attributes are drawn from the BAF.Map's Web.config
  'appSettings' section. They contain the prefix '{~$WebConfigSetting.'
  followed by the name of the appSetting. For example the name of the
  image file that is used to mark a location is specified by attribute
  '{~$WebConfigSetting.LocationMarkerFilename}'.

The Map request attributes:

  1. The '{~^RasterSizeX}' and '{~^RasterSizeY}' are taken from the 
	values of MapWidthPixels
  2. '{~^Resolution}' is from the PixelsPerInch value. 
  3. '{~^Extent}' is composed from the MapRequest's projected extent 
	(specifically the space-delimited western-most, southern-most, 
	eastern-most and northern-most coordinate values). 
  4 The '{~^MapOutputType}' is in the request as the MapOutputType. 
  5. The map extent (as well known text) is available in both Projected 
	(assumed to be Web Mercator) and Geographic (assumed to be WGS84) 
	forms as attributes '{~^MapExtentProjectedWKT}' and 
	'{~^MapExtentGeographicWKT}'.
  6 The {~^NominalScaleDenominator} is from the NominalScaleDenominator 
	value.

Attributes valid (although not necessarily meaningful) in the
BoilerplateText are:
  {~^RasterSizeX}, {~^RasterSizeY}
  {~^Extent}
  {~$WebConfigSetting.<keyName>}
  {~^Resolution}
  {~$ProjectionString.<srid>}
  {~$ConnectionString.<keyName>}
  {~^MapOutputType}
  {~^MapExtentProjectedWKT}
  {~^MapExtentGeographicWKT}
  {~^NominalScaleDenominator}

No map group layer attributes are valid.

Attributes valid (although not necessarily meaningful) in the MapLegendImage's
FilenameTextAttributenameComparisonvalueTuple:
  <any attribute valid for BoilerplateText>
  {~$ProjectionString.<srid>}
  {~@LayerName}
  {~^MapExtentProjectedWKT}
  {~^MapExtentGeographicWKT}
  {~^NominalScaleDenominator}
  <any map group layer attribute defined for the parent map layer group>

Attributes may be used to control conditional text inclusion in
the BoilerplateText and map layer templates. In either case, the
text may contain zero or more arbitrarily-nested 'IF' blocks, on one 
or more lines. The IF block consists of one or more nested sets of
  {~? {attribute-name} ...body... }
Boolean and comparison operators may be used in place of the above
'{attribute-name}' to create nested expressions. In such a case
'{attribute-name}' may be further replaced by other boolean
and comparison operators. The whitespace shown here is optional.
  1. NOT operator:
	{~! {attribute-name} }
  2. AND operator: (note use of '&amp;' in place of a naked ampersand)
	{~&amp; {attribute-name-1} {attribute-name-2} }
  3. OR  operator:
	{~| {attribute-name-1} {attribute-name-2} }
  4. Less Than operator:
	{~< {attribute-name-1} {attribute-name-2} }
  5. Equal To operator:
	{~= {attribute-name-1} {attribute-name-2} }
  6. Greater Than operator:
	{~> {attribute-name-1} {attribute-name-2} }

After substitution of the appropriate attribute value(s) and performing
the specified boolean and comparison operations, the IF-block
should resolve to one of the following two forms:
   {~? True ...body... }
   {~? False ...body... }
In the case of the 'True' condition the '...body...' is utilized; if
'False' it is discarded. Any other resolution represents an error.

Here is an example of a simple IF block:
  {~? {Show Labels}
	 label
	   Color {LabelColor}
	   Outlinecolor {LabelOutlineColor}
	   Outlinewidth {LabelOutlineWidth}
	   Font 'arial'
	   Position auto
	   type truetype
	   FORCE true
	   PRIORITY 9
	   size {LabelSize}
	 end  #end of label
  }

Here is a nested block that also shows an if/else structure and use of 'AND' and 'NOT':
  {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
	{~? {Show National Mapunit Symbols}
	  LabelItem 'NationalMapUnitSymbol'
	}
	{~? {~! {Show National Mapunit Symbols} }
	  LabelItem 'MapUnitSymbol'
	}
  }

Attribute names that are undefined yield an exception when the 
MapConfiguration is reviewed, either under RunDiagnostics, or when 
a mapfile string is being composed in production use for map image 
generation.


[4] Class-Specific Details

In general, 'Name' values must be non-empty strings and unique, either
within the containing node or within a broader context as described below.

Class - MapConfiguration
  There are no requirements specific to this class.

Class - Settings
  Settings must be defined.
  The DefaultViewExtentName must be defined in the MapModes set
  and must name a view defined in the VewExtent group.
  PixelsPerInch is requried.
  Zoom is required.

Class - ViewExtent
  The min/max lat/log values are assumed to be in WGS84.
  ViewExtent names must be unique across the set of ViewExtents
  and ViewExtentGroups.
  At least one ViewExtent is required.

Class - PixelsPerInch
  PixelsPerInch is required.
  The values must adhere to both
	0 < Minimum < Maximum
  and
	Minimum <= Default <= Maximum

Class - Zoom
  MapScale values and limits must be 
	0 < MinimumZoomScale < {MapScale} < MaximumZoomScale
  At least two MapScale values must be provided, and they must be in 
  descending numeric order.

Class - LegendCategory
  LegendCategory names must be unique.
  The boolean AreLayerGroupsMutuallyExclusive is used by the application
  to control whether only one layer group within a legend may be enabled
  at a time.

Class - MapMode
  At least one MapMode must be defined.
  All MapMode names must be unique.

Requirement = ScaleBar
  ScaleBar must be defined.

Class - ScaleBar

Class - MapServerBaseDefinition
  MapServerBaseDefinition must be defined.
  The BoilerplateText must be non-empty.
  All attributes referenced in the BoilerplateText must exist
  (see the section entitled 'The attribute system').

Class - MapserverProjectionDefinition
  At least one MapserverProjectionDefinition must be defined.

Class - DiagnosticRuntimeAttributes
  DiagnosticRuntimeAttributes must be defined.
  The names of individual DiagnosticRuntimeAttributes must be unique.
  The DiagnosticRuntimeAttributes must include definitions for
	 ~^Resolution
	 ~^Extent
	 ~^LocationMarkerPoint
	 ~^MapOutputType
	 ~^RasterSizeX
	 ~^RasterSizeY
	 ~^MapExtentProjectedWKT
	 ~^MapExtentGeographicWKT
	 ~^NominalScaleDenominator
  Note that the names are prefixed with the appropriate
  map attribute group prefix, no other types are permitted:
	configuration:  ~$
	map request:    ~^

Requirements - MapAttribute

  The Name must not contain left or right braces, the tilde, newline, 
  return, or tab. It may not start with a dollar sign, caret or ampersand.
  The Value may not be null.
  Ultimately the 'value' of an attribute is its 'StringValue'.
  The IsEditable flag controls whether the UI's Legend mechanism allows
  the user to edit the attribute, subject to constraints defined by
  the type (and possibly choice list or minimum and maximum) of the
  attribute.
  'Well-formed colors' are stored as a case-blind canonical string in 
  the form '#rrggbb, a hexadecimal value composed of a set of
  red, green and blue values, each in the inclusive range 00 to ff
  (hexadecimal, 0 to 255 decimal).
  For example,
	#000000 - black
	#ffffff - white
	#ff0000 - red
	#00ff00 - green
	#0000ff - blue
	#915C83 - Antique Fuchsia
  A MapAttribute is typed as one of the following (enum MapAttributeType):
	Boolean - accepts only true or false values.
	ClampedDouble - accepts a double-precision
	  numeric value between a specified minimum and maximum.
	ClampedInteger - accepts an integer
	  numeric value between a specified minimum and maximum.
	Color - accepts a 'well formed color' as its value.
	ColorRamp - accepts default, min and max 'well formed color' values.
	EnumeratedChoice - accepts a series of name and value
	  string pairs. Either the value and and individual
	  choice values must be 'well formed colors', nor none may be.
	  If IsEditable is true, there must be at least two choices.
	  Choice names must be unique within an attribute.
	  The value must be within the choice list.
	NameValue - accepts a name and a value. This is appropriate
	  for either non-editable value or one that allows unconstrained
	  user input.
  For the ClampedDouble and ClampedInteger,
  the following must hold:
	MinimumValue < MaximumValue
	MinimumValue <= Value
	Value <= MaximumValue

Class - LegendCategory
  Each LegendCategory must have a unique name.
  At least one LegendCategory is required.
  Each LegendCategory must contain at least one MapLayerGroup.

Class - MapLayerGroup
  Each MapLayerGroup name must be globally unique.
  Each MapLayerGroupId must be globally unique.
  There must be a non-empty, and non-repeating list of MapMode names.
  Each MapMode name must have been defined under the list defined within
  MapConfiguration.Settings.
  The MapLayerGroupId must be specified and be a positive integer.
  At least one Layer must be defined in the group.
  Each MapLayerGroup is instantiated by one of the following:
	MapLayerGroupPolygon - represents a data source containing
	  polygonal geometric features. The BoundaryWidth and 
	  BoundaryColor attributes must be defined for this group.
	  If the MapLegendType is 'dynamic', the Opacity attribute
	  must be defined.
	MapLayerGroupLine - represents a data source containing linear
	  geometric features.
	MapLayerGroupPoint - represents a data source containing 
	  point geometric features.
	MapLayerGroupOrthophoto - represents a background image source.
  The MinScaleDenom and MaxScaleDenom specify whether the layer group
  is visible at the current scale. A zero in either indicates that
  specific constraint does not apply in determining visibility.
  These limits are inclusive.
  All attributes defined within a map layer group must be
  uniquely named.
  The LayerGroupWriterClassName is used to select the class that handles
  mapfile writing and a few related functions.

Class - Layer
  Each Name must be unique within its parent MapLayerGroup.
  The DrawOrder must be a positive integer and globally unique.
  The layer with the lowest number is drawn first, and then successive 
  layers are drawn, possibly obscuring earlier layers.
  If the parent MapLayerGroup specifies that descriptions are present,
  then MapLayerDescriptionGroups must not be empty.
  If the parent layer group specifies that identification is possible,
  then the Identify information must be present.
  The MinScaleDenom and MaxScaleDenom specify the scale range over 
  which the layer may be drawn. Either may be zero to indicate that 
  the range end (either minimum or maximum) does not apply.
  MinScaleDenom must be zero or greater. MaxScaleDenom must either be 
  zero or greater than MinScaleDenom. These limits are inclusive.
  The LabelMinScaleDenom and LabelMaxScaleDenom specify the scale range over 
  which labels may be drawn. Either may be zero to indicate that 
  the range end (either minimum or maximum) does not apply.
  LabelMinScaleDenom must be zero or greater. LabelMaxScaleDenom must either be 
  zero or greater than MinScaleDenom. These limits are inclusive.
  The LayerType is one of Line, Point, Polygon, or Orthophoto.
  MapServerLayerTemplateText - This is the body of text, that after
  attribute value substitution, will become part of a mapfile.
  One or more brace enclosed attributes may be used.
  AvailablilityTestType - One of the values of enum LayerAvailableTestType.
  It may be specified to require a test of layer data availability
  before the layer is written to the mapfile text for drawing a map.
  SkipIfUnavailable - If this is true and the availability test is used,
  the layer will not be added to the map file; if false, an exception 
  will be thrown.
  AvailablilityTestString - The exact test is driven by this string which
  must be implemented in concert with the *LayerGroupWriter classes.
  Attribute interpolation is performed on this string.

Class - LayerDescriptionGroup
  The set of child layer descriptions must not be empty.

Class - LayerDescription
  The value may not be an empty string.

Class - MapLegend* Family
  The abstract MaplegendBase is instantiated as one of the following:
	 MapLegendNone - indicates that no legend is to be displayed.
	 MapLegendImage - The specified image is to be presented for
	   the legend. A set of one or more 
	   'FilenameTextAttributenameComparisonvalueTuple' specify
	   image filename(s) to display in the rendered legend.
	   The 'Text' is drawn as part of the legend.
	   The tuples may include the optional pair AttributeName
	   and ComparisonValue: the associated FileName image should 
	   only be drawn if the attribute's value matches the 
	   ComparisonValue. Any named attribute must be in the set
	   of map attributes for the layer group.
	   Optional ImageBackgroundFillColor and ImageBackgroundOpacity
	   (both either as mutually exclusive MapAttributeName or value)
	   may be added.
	MapLegendColor - The legend is drawn based upon the attributes
	   specified by BoundaryColorMapAttributeNameOrColor,
	   FillColorMapAttributeNameOrColor and Text; these must be in the set
	   of map attributes for the layer group. This legend type is
	   only valid of the layer group's type is polygon.
	   Optional BackgroundColor, FillColor and Opacity
	   (each either as mutually exclusive MapAttributeName or value)
	   may be added.
	MapLegendNone - specifies that no legend is to be drawn for
	   this layer group.

Class - LayerIdentify
  The list of child IdentifyAttributes must not be empty.
  Identification information is retrieved by means of a SQL command of the
  following form:
	SELECT {_selectList_} 
	FROM {Source} 
	WHERE {_spatialTest_} {StatementRemainder}
  Here,
	{_selectList_}
	  Generated from the individual IdentifyAttributes.ColumnName.
	{Source}
	  Everything that would go into a FROM clause
	{_spatialTest_}
	  Generated from the location and GeometryColumn
	{StatementRemainder}
	  Anything that can follow the 'WHERE {_spatialTest_}'.
	  Note that additional WHERE tests can be included by starting
	  with an 'AND' operator.
  Individual attributes of LayerIdentify:
	ConnectionKey - a 'DSN' string specifying database source (such as
	  host and port), database name, username and password).
	  A brace-enclosed attribute name may be specified.
	  Required.
	SRID - The projection number. Must be a positive integer.
	  A brace-enclosed attribute name (or expression) may be specified.
	  Required.
	GeometryColumn - The geometry column name in the data source table.
	  A brace-enclosed attribute name (or expression) may be specified.
	  Required.
	Source - the 'FROM' clause's source (typically a single table, may
	  include JOINs, index hints, etc.). 
	  A brace-enclosed attribute name (or expression) may be specified.
	  Required.
	StatementRemainder - Any additional fragments needed for the Sql 
	  command. 
	  A brace-enclosed attribute name (or expression) may be specified.
	  Optional.

Class - LayerIdentifyAttribute
  The ColumnName must be specified and unique within the parent LayerIdentify.
  The DisplayName must be specified and unique within the parent LayerIdentify.
  The ColumnName will be used in conjunction with the Sources. Note that 
  ColumnName, if referencing a numeric column, can also include a Sql 
  'ltrim(str(...))' format specification. For example, in layer AOI, the 
  column AREAACRES can be specified as
	ltrim(str(AREAACRES,30,1))
  to show a number with one decimal place in a 30-character-wide field
  (that width is not really relevant, it should be at least wide enough for
  all reasonable numeric values). A 'case' phrase can control precision:
	case when AREAACRES < 0.1 then ltrim(str(AREAACRES,30,2)) else ltrim(str(AREAACRES,30,2)) end
  Also note that when in the context of an XML document, the HTML Reserved
  characters need to be escaped (quotation mark, apostrophe, ampersand,
  less-than, greater-than as per 'HTML ISO-8859-1 Reference', 
  http://www.w3schools.com/tags/ref_entities.asp). The escaped form would
  be:
   case when AREAACRES &lt; 0.1 then ltrim(str(AREAACRES,30,2)) else ltrim(str(AREAACRES,30,2)) end
  When using 'str(...)', null values are passed through as a null value, 
  so an explicit 'isnull(...)' function should be used as appropriate.  
  If DisplayEmptyValue is false, null (or empty) values are not returned. 
 -->

<MapConfiguration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Settings>
	<PixelsPerInch Default="70" Minimum="40" Maximum="350" />
	<DefaultViewExtentName>Contiguous U.S.</DefaultViewExtentName>
	<ViewExtents>
	  <ViewExtent Name="Contiguous U.S." MinimumLongitude="-126" MinimumLatitude="23.9" MaximumLongitude="-66" MaximumLatitude="50" />
	  <ViewExtent Name="Alaska" MinimumLongitude="-166" MinimumLatitude="54.9" MaximumLongitude="-126" MaximumLatitude="71.7" />
	  <ViewExtent Name="Hawaii" MinimumLongitude="-161" MinimumLatitude="18" MaximumLongitude="-154" MaximumLatitude="23" />
	  <ViewExtentGroup Name="Pacific Basin">
		<ViewExtents>
		  <ViewExtent Name="American Samoa" MinimumLongitude="-174" MinimumLatitude="-18" MaximumLongitude="-167" MaximumLatitude="-10" />
		  <ViewExtent Name="Federated States of Micronesia" MinimumLongitude="135" MinimumLatitude="1" MaximumLongitude="165" MaximumLatitude="12" />
		  <ViewExtent Name="Guam" MinimumLongitude="144.4" MinimumLatitude="13.15" MaximumLongitude="145.2" MaximumLatitude="13.75" />
		  <ViewExtent Name="Marshall Islands" MinimumLongitude="160" MinimumLatitude="4" MaximumLongitude="173" MaximumLatitude="13" />
		  <ViewExtent Name="Palau" MinimumLongitude="134" MinimumLatitude="6.5" MaximumLongitude="135" MaximumLatitude="8.5" />
		  <ViewExtent Name="Northern Mariana Islands" MinimumLongitude="144.5" MinimumLatitude="13.75" MaximumLongitude="146.5" MaximumLatitude="21.2" />
		</ViewExtents>
	  </ViewExtentGroup>
	  <ViewExtent Name="Puerto Rico" MinimumLongitude="-69" MinimumLatitude="17.2" MaximumLongitude="-64.2" MaximumLatitude="19" />
	  <ViewExtent Name="Virgin Islands" MinimumLongitude="-65.2" MinimumLatitude="17.6" MaximumLongitude="-64.6" MaximumLatitude="18.5" />
	</ViewExtents>
	<Zoom MinimumZoomScale="100">
	  <ZoomScales>
		<MapScale>100000</MapScale>
		<MapScale>50000</MapScale>
		<MapScale>24000</MapScale>
		<MapScale>20000</MapScale>
		<MapScale>15840</MapScale>
		<MapScale>12000</MapScale>
		<MapScale>7920</MapScale>
		<MapScale>6000</MapScale>
		<MapScale>3960</MapScale>
		<MapScale>3000</MapScale>
		<MapScale>1500</MapScale>
		<MapScale>720</MapScale>
	  </ZoomScales>
	</Zoom>
	<MaxAoiSize>100000</MaxAoiSize>
	<MinAoiSize>0.05</MinAoiSize>
	<ScaleBar MaximumFineScaleDenominator="150000" />
	<MapModes>
	  <Name>Area of Interest</Name>
			<Name>Soil Data Explorer:Suitabilities and Limitations for Use</Name>
			<Name>Soil Data Explorer:Soil Properties and Qualities</Name>
			<Name>Soil Data Explorer:Ecological Site Assessment</Name>
			<Name>Soil Data Explorer:Soil Reports</Name>
			<Name>Soil Map</Name>
	  <Name>Preview</Name>
	  <Name>Report Cover Map</Name>
	</MapModes>
	<MapServerBaseDefinition>
	  <BoilerplateText>
			STATUS ON
			imagetype '{~^MapOutputType}'
			OUTPUTFORMAT
			NAME 'svg'
			DRIVER CAIRO/SVG
			MIMETYPE 'image/svg+xml'
			IMAGEMODE RGB
			EXTENSION 'svg'
			END
			OUTPUTFORMAT
			NAME 'png'
			DRIVER AGG/PNG
			MIMETYPE 'image/png'
			IMAGEMODE RGBA
			EXTENSION 'png'
			END
			SIZE {~^RasterSizeX} {~^RasterSizeY}
			EXTENT {~^Extent}
			UNITS METERS
			IMAGECOLOR '#ffffff'
			FONTSET '{~$WebConfigSetting.MapServerFontsetFilename}'
			RESOLUTION {~^Resolution}
			DEFRESOLUTION 70
			{~$Projection.3857}
			# Projected extent WKT:  {~^MapExtentProjectedWKT}
			# Geographic extent WKT: {~^MapExtentGeographicWKT}
			# NominalScaleDenominator: {~^NominalScaleDenominator}

			layer
			name 'brute-force background'
			type polygon
			{~? {~= {~^MapOutputType} {CONSTANT_STRING_svg} } STATUS ON }
			{~? {~! {~= {~^MapOutputType} {CONSTANT_STRING_svg} } }
			{~?     {Use Quick Background}   STATUS OFF }
			{~? {~! {Use Quick Background} } STATUS ON  }
			}
			transform false
			feature
			points 0 0 0 {~^RasterSizeY} {~^RasterSizeX} {~^RasterSizeY} {~^RasterSizeX} 0 0 0 end
			end
			class
			style color '{Background Color}' end
			end
			end # end of layer 'brute-force background'

			symbol
			name 'circle'
			filled true
			type ellipse
			points 0 0 1 1 end
			end

			symbol
			name 'hatch'
			type hatch
			end

			symbol
			name 'triangle'
			type vector
			points  0 4  2 0  4 4  0 4  end
			filled true
			end

			symbol
			name 'map unit point'
			type vector
			points 0 0  0 1  1 1  1 0  0 0  end
			filled true
			end
		</BoilerplateText>
	  <ProjectionDefinitions>
		<MapserverProjectionDefinition Srid="3857">
		  <Definition>PROJECTION 'proj=merc' 'a=6378137' 'b=6378137' 'lat_ts=0.0' 'lon_0=0.0' 'x_0=0.0' 'y_0=0' 'k=1.0' 'units=m' 'nadgrids=@null' 'north' 'no_defs' END</Definition>
		  <Comment>3857: WebMercator</Comment>
		</MapserverProjectionDefinition>
		<MapserverProjectionDefinition Srid="4267">
		  <Definition>PROJECTION 'proj=longlat' 'ellps=clrk66' 'datum=NAD27' 'no_defs' END</Definition>
		  <Comment>4267: NAD27</Comment>
		</MapserverProjectionDefinition>
		<MapserverProjectionDefinition Srid="4269">
		  <Definition>PROJECTION 'proj=latlong' 'ellps=GRS80' 'datum=NAD83' END</Definition>
		  <Comment>4269: NAD83</Comment>
		</MapserverProjectionDefinition>
		<MapserverProjectionDefinition Srid="4326">
		  <Definition>PROJECTION 'proj=latlong' 'ellps=WGS84' 'datum=WGS84' END</Definition>
		  <Comment>4326: WGS84</Comment>
		</MapserverProjectionDefinition>
		<MapserverProjectionDefinition Srid="104000">
		  <Definition>PROJECTION 'proj=longlat' 'ellps=clrk66' 'datum=NAD27' 'no_defs' END</Definition>
		  <Comment>104000: ESRI GCS Assumed Geographic 1</Comment>
		</MapserverProjectionDefinition>
	  </ProjectionDefinitions>
	</MapServerBaseDefinition>
	<DiagnosticRuntimeAttributes>
	  <NameAndValueStringPair Name="~^Resolution" Value="70" />
	  <NameAndValueStringPair Name="~^Extent" Value="-13234086.3059592 3976767.37231785 -13083761.5787869 4069489.50206934" />
	  <NameAndValueStringPair Name="~^MapExtentProjectedWKT" Value="Polygon((-13234086.3059592 3976767.37231785, -13083761.5787869 3976767.37231785, -13083761.5787869 4069489.50206934, -13234086.3059592 4069489.50206934, -13234086.3059592 3976767.37231785))" />
	  <NameAndValueStringPair Name="~^MapExtentGeographicWKT" Value="Polygon((-118.88382 33.6115962952678, -117.53343 33.6115962952678, -117.53343 34.3024735149003, -118.88382 34.3024735149003, -118.88382 33.6115962952678))" />
	  <NameAndValueStringPair Name="~^LocationMarkerPoint" Value="-117.6793022 33.78523007" />
	  <NameAndValueStringPair Name="~^RasterSizeX" Value="916" />
	  <NameAndValueStringPair Name="~^RasterSizeY" Value="565" />
	  <NameAndValueStringPair Name="~^MapOutputType" Value="png" />
	  <NameAndValueStringPair Name="~^NominalScaleDenominator" Value="50000" />
	  <NameAndValueStringPair Name="~$ConnectionString.BafConnectionString" Value="server=10.203.23.72,26022;database=baf;uid=...;pwd=..." />
	  <NameAndValueStringPair Name="~$ConnectionString.NrcsSpatialMartConnectionString" Value="server=10.203.23.72,26022;database=nrcsspatialmart;uid=...;pwd=..." />
	  <NameAndValueStringPair Name="~$ConnectionString.SdmConnectionString" Value="server=10.203.23.72,26022;database=sdm;uid=...;pwd=..." />
	</DiagnosticRuntimeAttributes>
  </Settings>
  <MapAttributes>
	<MapAttribute AttributeType="Boolean" Name="Show National Mapunit Symbols" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
	<MapAttribute AttributeType="ClampedInteger" Name="AoiID" StringValue="0" IsEditable="false" MinValue="0" MaxValue="2147483647" />
	<MapAttribute AttributeType="Boolean" Name="AoiIsSSA" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
	<MapAttribute AttributeType="NameValue" Name="AoiAreasymbol" StringValue="" IsEditable="false" MinValue="" MaxValue="" />
	<MapAttribute AttributeType="NameValue" Name="MapMode_Area_of_Interest" StringValue="Area of Interest" IsEditable="false" MinValue="" MaxValue="" />
	<MapAttribute AttributeType="Color" Name="Background Color" StringValue="#F5F5F5" IsEditable="false" MinValue="" MaxValue="" />
		<MapAttribute AttributeType="Boolean" Name="Use Quick Background" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
		<MapAttribute AttributeType="EnumeratedChoice" Name="Map Mode" StringValue="Area of Interest" IsEditable="false" MinValue="" MaxValue="">
			<ChoiceList Name="Area of Interest" Value="Area of Interest" />
			<ChoiceList Name="Soil Data Explorer:Suitabilities and Limitations for Use" Value="Soil Data Explorer:Suitabilities and Limitations for Use" />
			<ChoiceList Name="Soil Data Explorer:Soil Properties and Qualities" Value="Soil Data Explorer:Soil Properties and Qualities" />
			<ChoiceList Name="Soil Data Explorer:Ecological Site Assessment" Value="Soil Data Explorer:Ecological Site Assessment" />
			<ChoiceList Name="Soil Data Explorer:Soil Reports" Value="Soil Data Explorer:Soil Reports" />
			<ChoiceList Name="Soil Map" Value="Soil Map" />
	  <ChoiceList Name="Preview" Value="Preview" />
	  <ChoiceList Name="Report Cover Map" Value="Report Cover Map" />
	</MapAttribute>
	<MapAttribute AttributeType="ClampedDouble" Name="MapunitPolygonDrawingStrategy_ThresholdFractionSsaAoi" StringValue="0.20" IsEditable="true" MinValue="0" MaxValue="1" />
	<MapAttribute AttributeType="ClampedDouble" Name="MapunitPolygonDrawingStrategy_ThresholdFractionNonSsaAoi" StringValue="0.10" IsEditable="true" MinValue="0" MaxValue="1" />
	<MapAttribute AttributeType="Boolean" Name="Use Quick Background" StringValue="true" IsEditable="false" MinValue="" MaxValue="" />
		<MapAttribute AttributeType="NameValue" Name="CONSTANT_STRING_png" StringValue="png" IsEditable="false" MinValue="" MaxValue="" />
		<MapAttribute AttributeType="NameValue" Name="CONSTANT_STRING_svg" StringValue="svg" IsEditable="false" MinValue="" MaxValue="" />
	</MapAttributes>
  <LegendCategories>
	<LegendCategory Name="Area of Interest (AOI)" AreLayerGroupsMutuallyExclusive="false">
	  <MapLayerGroups>
		<MapLayerGroupPolygon Name="Area of Interest (AOI)" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="1" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Hashmarks" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="true" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#00cccc" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#ff0000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="3" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="8" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="6" />
			  <ChoiceList Name="Medium" Value="8" />
			  <ChoiceList Name="Large" Value="10" />
			  <ChoiceList Name="Very Large" Value="12" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="AOI" DrawOrder="745" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.BafConnectionString}" GeometryColumn="AoiPartProj" SRID="3857" Source="AoiPart with(nolock)" StatementRemainder="AND AoiID={AoiID}">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="case when AoiPartAcreage is null then '' when AoiPartAcreage &lt; 10.0 then ltrim(str(AoiPartAcreage,30,2)) when AoiPartAcreage &lt; 1000.0 then ltrim(str(AoiPartAcreage,30,1)) else ltrim(substring(convert(char(30), cast(round(AoiPartAcreage,0) as money), 1), 1, 27)) end" DisplayName="Area (acres in this part)" DisplayEmptyValue="false" />
					<LayerIdentifyAttribute ColumnName="{AoiID}" DisplayName="AoiID" DisplayEmptyValue="false" />
					<LayerIdentifyAttribute ColumnName="AoiPartName" DisplayName="Part name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
					LAYER
					TYPE POLYGON
					NAME '{~@LayerName}'
					STATUS ON
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'
					DATA "AoipartProj from (select AoipartProj, AoiID, AoiPartName  from AoiPart as base_table  where AoiID={AoiID} ) as subqry using unique AoiID using SRID=3857"
					composite OPACITY {Opacity} end
					CLASS
						STYLE
						OUTLINECOLOR '{Boundary Color}'
						WIDTH {Boundary Width}
					END
								{~? {~&amp; {Show Hashmarks} {~= {Map Mode} {MapMode_Area_of_Interest} } }
					STYLE
					SYMBOL 'hatch'
					COLOR '{Boundary Color}'
					ANGLE 45
					WIDTH {Boundary Width}
					SIZE 15
					END
					}
					{~? {Show Labels}
					LABEL
					COLOR 0 0 51  # dark blue
					Font 'arial-bold'
					Position auto
					type truetype
					PRIORITY 10
					size 10
					style
					geomtransform 'labelpoly'
					color 153 255 102
					end  #end of label style
					end  #end of label
					}
					END # end of CLASS
					{~? {Show Labels} LABELITEM 'AoiPartName' }
					END  # end of layer '{~@LayerName}'
				</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="AOI.png" Text="Area of Interest (AOI)" AttributeName="Show Hashmarks" ComparisonValue="True" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="AOI_No_Hash.png" Text="Area of Interest (AOI)" AttributeName="Show Hashmarks" ComparisonValue="False" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPolygon>
		<MapLayerGroupPoint Name="Location Marker" HasLayerDescriptions="false" IsIdentifiable="false" MapLayerGroupId="33" MapLayerType="Point" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Size" StringValue="14" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="1" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="0" IsEditable="false" MinValue="0" MaxValue="100" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Location Marker" DrawOrder="1000" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								symbol name 'LocationMarker'
								type pixmap
								image '{~$WebConfigSetting.LocationMarkerFilename}'
								end
								LAYER
								TYPE POINT
								POSTLABELCACHE true
								NAME '{~@LayerName}'
								{~$Projection.4326}
								STATUS ON
								FEATURE
								POINTS {~^LocationMarkerPoint} END
								#   TEXT ' '  # a single space character
								END
								CLASS
								STYLE
								SYMBOL 'LocationMarker'
								size {Size}
								END
								END # end of CLASS
								END # end of layer '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="LocationMarker.png" Text="Location Marker" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPoint>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
	<LegendCategory Name="Soils" AreLayerGroupsMutuallyExclusive="false">
	  <MapLayerGroups>
		<MapLayerGroupPolygon Name="Soil Survey Areas" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="2" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="5000000" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="0.2" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#e1dd00" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="9" />
			  <ChoiceList Name="Very Large" Value="11" />
			</MapAttribute>
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#e1dd00" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="7" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="30" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Survey Areas" DrawOrder="740" MinScaleDenom="0" MaxScaleDenom="5000000" LabelMinScaleDenom="100000" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.SdmConnectionString}" GeometryColumn="sapolygonproj" SRID="3857" 
									Source="sastatusmap M left join legend L on M.areasymbol = L.areasymbol">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="M.AREASYMBOL" DisplayName="Soil Survey Area Symbol" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="M.AREANAME" DisplayName="Soil Survey Area Name" DisplayEmptyValue="false" />
					<LayerIdentifyAttribute ColumnName="'1:' + cast(L.projectScale as varchar(10))" DisplayName="Project Scale" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Soil Survey Area Boundaries: The boundaries of soil survey areas can correspond to county boundaries, physiographic boundaries, tribal boundaries, federal agency management boundaries, or other land management areas. Two or more small counties may be combined to form the survey area, or large counties and physiographic areas may be subdivided for efficiency of field operations and publication of a final product. Cooperating agencies of the National Cooperative Soil Survey designate the boundaries of soil survey areas in consultation with major users of soil information." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
					LAYER
					Name '{~@LayerName}'
					TYPE POLYGON
					STATUS ON
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.SdmConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'
					DATA "sapolygonproj from sastatusmap as base_table using unique sapolygonkey using SRID=3857"
					composite OPACITY {Opacity} end
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LabelItem 'AreaName'
								}
								class
								style
								WIDTH {Boundary Width}
								Outlinecolor '{Boundary Color}'
								end # of style
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Outlinecolor '{Label Outline Color}'
								Outlinewidth {Label Outline Width}
								Font 'arial-bold'
								Position auto
								type truetype
								size {Label Size}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								end  # of class
								END # end of layer '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Soil Map Unit Polygons" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="3" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="0"  CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0.75" IsEditable="true" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ColorRamp" Name="Boundary Color" StringValue="#FF8000" IsEditable="true" MinValue="#F7C000" MaxValue="#FF8000" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="9" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
      <MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
      </MapAttributes>
		  <MapModes>
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Map Unit Polygons" DrawOrder="700" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="50000" AvailablilityTestType="None" SkipIfUnavailable="false">
				<Identify
						ConnectionKey="{~$ConnectionString.BafConnectionString}"
						GeometryColumn=	"{~? {~! {AoiIsSSA} } AoiSoilMapunitPolygonProj } {~? {AoiIsSSA} MUP.mupolygonproj }"
						SRID="3857"
						Source="{~? {~! {AoiIsSSA} } AoiSoilMapunitPolygon with(nolock)} {~? {AoiIsSSA} baf.dbo.aoi as A with(nolock), sdm.dbo.mupolygon as MUP with(index(SI_mupolygon_24877)) join sdm.dbo.mapunit as MU on MUP.mukey = MU.mukey }"
						StatementRemainder="{~? {~! {AoiIsSSA} } AND AoiID={AoiID} } {~? {AoiIsSSA}  AND A.AoiID={AoiID} and A.areasymbol = MUP.areasymbol }" >
					<IdentifyAttributes>
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITNAME } {~? {AoiIsSSA} MU.muname }"
							DisplayName="Map Unit Name" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITSYMBOL } {~? {AoiIsSSA} MU.musym }"
							DisplayName="Map Unit Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITKEY } {~? {AoiIsSSA} MU.mukey }"
							DisplayName="Map Unit Key" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } AREASYMBOL } {~? {AoiIsSSA} A.areasymbol }"
							DisplayName="Soil Survey Area Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } NATIONALMAPUNITSYMBOL } {~? {AoiIsSSA} MU.nationalmusym }"
							DisplayName="National Map Unit Symbol" DisplayEmptyValue="false" />
					</IdentifyAttributes>
				</Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Detailed Soil Map Unit Boundaries: A soil map unit is a collection of areas defined and named the same, in terms of their soil components or miscellaneous areas or both. Each map unit differs in some respect from all others in a survey area, and each map unit has a symbol that uniquely identifies the map unit on a soil map. Each individual area so identified on the map is a delineation. Soil scientists specially design map units to meet the needs of the major users within a soil survey area." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
					LAYER
					Name '{~@LayerName}'
					TYPE POLYGON
					STATUS ON
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'
					DATA "AoiSoilMapunitPolygonProj from (select projectedGeometry as AoiSoilMapunitPolygonProj, id as AoiSoilMapunitPolygonId, MapUnitSymbol, NationalMapUnitSymbol from dbo.BAF_GetMappingPolygons_MapUnitPolygon({AoiID}, '{~^MapExtentProjectedWKT}', 3857, {MapunitPolygonDrawingStrategy_ThresholdFractionSsaAoi}, {MapunitPolygonDrawingStrategy_ThresholdFractionNonSsaAoi}) ) as subqry using unique AoiSoilMapunitPolygonId using SRID=3857"
					composite OPACITY {Opacity} end
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					{~? {Show National Mapunit Symbols}
					LabelItem 'NationalMapUnitSymbol'
					}
					{~? {~! {Show National Mapunit Symbols} }
					LabelItem 'MapUnitSymbol'
					}
					}
					class
					{~? {~> {~^Indefinite Boundary Width} {Boundary Width} }
					style  # for the indefinite line
					WIDTH {~^Indefinite Boundary Width}
					Outlinecolor '{Boundary Color}'
						opacity {Indefinite Boundary Opacity}
					end # of style
					}
					style
					WIDTH {Boundary Width}
					Outlinecolor '{Boundary Color}'
					end # of style
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Outlinecolor '{Label Outline Color}'
								Outlinewidth {Label Outline Width}
								Font 'arial-bold'
								Position auto
								type truetype
								PRIORITY {Label Priority}
								size {Label Size}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								end  # of class
								END # end of layer '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupLine Name="Soil Map Unit Lines" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="90" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="true" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="ColorRamp" Name="Line Color" StringValue="#FF8000" IsEditable="true" MinValue="#F7C000" MaxValue="#FF8000" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="9" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
			<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Map Unit Lines" DrawOrder="721" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="50000" AvailablilityTestType="None" SkipIfUnavailable="false">
				<Identify
						ConnectionKey="{~$ConnectionString.BafConnectionString}"
						GeometryColumn=	"{~? {~! {AoiIsSSA} } AoiSoilMapunitLineProj } {~? {AoiIsSSA} MUP.muLineproj }"
						SRID="3857"
						Source="{~? {~! {AoiIsSSA} } AoiSoilMapunitLine with(nolock)} {~? {AoiIsSSA} baf.dbo.aoi as A with(nolock), sdm.dbo.muLine as MUP with(index(SI_muline_24871)) join sdm.dbo.mapunit as MU on MUP.mukey = MU.mukey }"
						StatementRemainder="{~? {~! {AoiIsSSA} } AND AoiID={AoiID} } {~? {AoiIsSSA}  AND A.AoiID={AoiID} and A.areasymbol = MUP.areasymbol }" >
					<IdentifyAttributes>
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITNAME } {~? {AoiIsSSA} MU.muname }"
							DisplayName="Map Unit Name" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITSYMBOL } {~? {AoiIsSSA} MU.musym }"
							DisplayName="Map Unit Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITKEY } {~? {AoiIsSSA} MU.mukey }"
							DisplayName="Map Unit Key" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } AREASYMBOL } {~? {AoiIsSSA} A.areasymbol }"
							DisplayName="Soil Survey Area Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } NATIONALMAPUNITSYMBOL } {~? {AoiIsSSA} MU.nationalmusym }"
							DisplayName="National Map Unit Symbol" DisplayEmptyValue="false" />
					</IdentifyAttributes>
				</Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Detailed Soil Map Unit Lines: ...to be defined..." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
				  LAYER
				  NAME '{~@LayerName}'
				  STATUS ON
				  {~$Projection.3857}
				  CONNECTIONTYPE PLUGIN
				  PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
				  CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
				  PROCESSING 'CLOSE_CONNECTION=DEFER'

				  DATA "AoiSoilMapunitLineProj from (
				  {~? {~! {AoiIsSSA} }
				  select AoiSoilMapUnitLineProj, MapUnitSymbol,
				  NationalMapUnitSymbol, MapUnitKey,
				  AoiSoilMapunitLineId
				  from AoiSoilMapUnitLine where AoiID={AoiID}
				  }
				  {~? {AoiIsSSA}
				  select muLineproj as AoiSoilMapUnitLineProj, musym as MapUnitSymbol,
				  nationalmusym as NationalMapUnitSymbol, mukey as MapUnitKey,
				  muLinekey as AoiSoilMapunitLineId
				  from sdm.dbo.muLine with(index(SI_muline_24871)) where muLineproj is not null and areasymbol='{AoiAreasymbol}'
				  }
				  ) as subqry using unique AoiSoilMapunitLineId using SRID=3857"

				  
				  TYPE LINE
				  {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					{~? {Show National Mapunit Symbols}
					LabelItem 'NationalMapUnitSymbol'
					}
					{~? {~! {Show National Mapunit Symbols} }
					LabelItem 'MapUnitSymbol'
					}
					}
					CLASS
					{~? {~> {~^Indefinite Boundary Width} {Line Width} }
					STYLE #outline indefinite
					WIDTH {~^Indefinite Boundary Width}
					COLOR '{Line Color}'
						OPACITY {Indefinite Boundary Opacity}
					END # end of STYLE
					}
					STYLE
					WIDTH {Line Width}
					COLOR '{Line Color}'
						OPACITY {Opacity}
					END
					STYLE #black dashed line
					WIDTH {Line Width}
					COLOR '#000000'
					PATTERN 1 8 END
						OPACITY {Opacity}
					END # end of STYLE
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								# the line-following label details, all experimental
								BUFFER 14           # nominal 1/5 inch separation between labels
								REPEATDISTANCE 280  # nominal 4 inch line distance
								ANGLE FOLLOW
								MAXOVERLAPANGLE 22.5
								MINFEATURESIZE auto
								end  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false" ImageBackgroundFillColorMapAttributeName="Line Color" ImageBackgroundOpacityMapAttributeName="Opacity">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="SoilMapUnitLine.png" Text="Soil Map Unit Lines" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupPoint Name="Soil Map Unit Points" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="91" MapLayerType="Point" MinScaleDenom="0" MaxScaleDenom="0"  CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedInteger" Name="Symbol Size" StringValue="6" IsEditable="true" MinValue="5" MaxValue="10" />
			<MapAttribute AttributeType="ColorRamp" Name="Fill Color" StringValue="#FF8000" IsEditable="true" MinValue="#F7C000" MaxValue="#FF8000" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="9" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="9" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Map Unit Points" DrawOrder="722" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="50000" AvailablilityTestType="None" SkipIfUnavailable="false">
				<Identify
						ConnectionKey="{~$ConnectionString.BafConnectionString}"
						GeometryColumn=	"{~? {~! {AoiIsSSA} } AoiSoilMapunitPointProj } {~? {AoiIsSSA} MUP.muPointproj }"
						SRID="3857"
						Source="{~? {~! {AoiIsSSA} } AoiSoilMapunitPoint with(nolock)} {~? {AoiIsSSA} baf.dbo.aoi as A with(nolock), sdm.dbo.muPoint as MUP with(index(SI_mupoint_24874)) join sdm.dbo.mapunit as MU on MUP.mukey = MU.mukey }"
						StatementRemainder="{~? {~! {AoiIsSSA} } AND AoiID={AoiID} } {~? {AoiIsSSA}  AND A.AoiID={AoiID} and A.areasymbol = MUP.areasymbol }" >
					<IdentifyAttributes>
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITNAME } {~? {AoiIsSSA} MU.muname }"
							DisplayName="Map Unit Name" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITSYMBOL } {~? {AoiIsSSA} MU.musym }"
							DisplayName="Map Unit Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } MAPUNITKEY } {~? {AoiIsSSA} MU.mukey }"
							DisplayName="Map Unit Key" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } AREASYMBOL } {~? {AoiIsSSA} A.areasymbol }"
							DisplayName="Soil Survey Area Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } NATIONALMAPUNITSYMBOL } {~? {AoiIsSSA} MU.nationalmusym }"
							DisplayName="National Map Unit Symbol" DisplayEmptyValue="false" />
					</IdentifyAttributes>
				</Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Detailed Soil Map Unit Lines: ...to be defined..." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
				  LAYER
				  NAME '{~@LayerName}'
				  STATUS ON
				  {~$Projection.3857}
				  CONNECTIONTYPE PLUGIN
				  PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
				  CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
				  PROCESSING 'CLOSE_CONNECTION=DEFER'

				  DATA "AoiSoilMapunitPointProj from (
				  {~? {~! {AoiIsSSA} }
				  select AoiSoilMapUnitPointProj, MapUnitSymbol,
				  NationalMapUnitSymbol, MapUnitKey,
				  AoiSoilMapunitPointId
				  from AoiSoilMapUnitPoint where AoiID={AoiID}
				  }
				  {~? {AoiIsSSA}
				  select mupointproj as AoiSoilMapUnitPointProj, musym as MapUnitSymbol,
				  nationalmusym as NationalMapUnitSymbol, mukey as MapUnitKey,
				  mupointkey as AoiSoilMapunitPointId
				  from sdm.dbo.mupoint with(index(SI_mupoint_24874)) where mupointproj is not null and areasymbol='{AoiAreasymbol}'
				  }
				  ) as subqry using unique AoiSoilMapunitPointId using SRID=3857"

				  
				  TYPE POINT
				  {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					{~? {Show National Mapunit Symbols}
					LabelItem 'NationalMapUnitSymbol'
					}
					{~? {~! {Show National Mapunit Symbols} }
					LabelItem 'MapUnitSymbol'
					}
					}
					CLASS

					{~? {~> {~^Indefinite Boundary Width} {Symbol Size} }
					style
					symbol 'circle'
					size {~^Indefinite Boundary Width}
						OPACITY {Indefinite Boundary Opacity}
					color '{Fill Color}'
					Outlinecolor '{Boundary Color}'
					Outlinewidth {Boundary Width}
					end
					}

					style
					color '{Fill Color}'
					OutlineColor '{Boundary Color}'
					OutlineWidth {Boundary Width}
					size {Symbol Size}
					symbol 'map unit point'
						OPACITY {Opacity}
					end
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position uc
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								OFFSET 0 2
								end  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false" ImageBackgroundFillColorMapAttributeName="Fill Color" ImageBackgroundOpacityMapAttributeName="Opacity">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="SoilMapUnitPoint.png" Text="Soil Map Unit Points" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPoint>
		<MapLayerGroupPolygon Name="Soil Rating Polygons" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="4" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="50" IsEditable="true" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="AoiSoilThematicMapID" StringValue="0" IsEditable="false" MinValue="0" MaxValue="2147483647" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0.5" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="9" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Color" Name="Not Rated Or Unavailable Color" StringValue="#dcdcdc" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="NameValue" Name="Outline Opacity" StringValue="100" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
			<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
			<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
			<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
			<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
			<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Rating Polygons" DrawOrder="730" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="50000" AvailablilityTestType="None" SkipIfUnavailable="false">
				<Identify ConnectionKey="{~$ConnectionString.BafConnectionString}" 
					GeometryColumn="{~? {~! {AoiIsSSA} }AoiSoilMapUnitPolygonProj } {~? {AoiIsSSA} mupolygonproj }" 
					SRID="3857" 
					Source="{~? {~! {AoiIsSSA} } AoiSoilMapUnitPolygon as base_table with(nolock) left join AoiSoilThematicMapRating as ratings with(nolock) on (ratings.AoiID = base_table.AoiID and ratings.MapUnitKey = base_table.MapUnitKey) } {~? {AoiIsSSA} sdm.dbo.mupolygon as base_table with(index(SI_mupolygon_24877)), sdm.dbo.mapunit as MU left join AoiSoilThematicMapRating as ratings with(nolock) on ratings.MapUnitKey = MU.mukey }"
					StatementRemainder="{~? {~! {AoiIsSSA} } AND base_table.AoiID={AoiID} and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} } {~? {AoiIsSSA} AND base_table.areasymbol='{AoiAreasymbol}' and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} and base_table.mukey = MU.mukey }"
				  >
					<IdentifyAttributes>
					  <LayerIdentifyAttribute 
							ColumnName="{~? {~! {AoiIsSSA} } ratings.MapUnitRatingString } {~? {AoiIsSSA} ratings.MapUnitRatingString }"
							DisplayName="Soil Ratings Value" DisplayEmptyValue="true" />
					  <LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } base_table.mapunitname } {~? {AoiIsSSA} MU.muname }"
							DisplayName="Map Unit Name" DisplayEmptyValue="false" />
					  <LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } base_table.mapunitsymbol } {~? {AoiIsSSA} base_table.musym }"
							DisplayName="Map Unit Symbol" DisplayEmptyValue="false" />
					  <LayerIdentifyAttribute
							ColumnName="{~? {~! {AoiIsSSA} } base_table.nationalmapunitsymbol } {~? {AoiIsSSA} base_table.nationalmusym }"
							DisplayName="National Map Unit Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute 
							ColumnName="case when {AoiSoilThematicMapID} > 0 then {AoiSoilThematicMapID} else null end" 
							DisplayName="ThematicMapID" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="case when '{AoiIsSSA}' = 'False' and {AoiSoilThematicMapID} > 0 then 					
							'!LINK!https://{~$WebConfigSetting.SdaFqdn}/spatial/SDM.wms?THEMATICMAPID={AoiSoilThematicMapID}&amp;VERSION=1.1.1&amp;REQUEST=GetMap&amp;LAYERS=MapunitPolyThematic&amp;SRS=EPSG:3857&amp;WIDTH={~^RasterSizeX}&amp;HEIGHT={~^RasterSizeY}&amp;FORMAT=image/png!KNIL!'
							else null end"
							DisplayName="thematic map (Web Mercator)" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
							ColumnName="case when '{AoiIsSSA}' = 'False' and {AoiSoilThematicMapID} > 0 then      
							'!LINK!https://{~$WebConfigSetting.SdaFqdn}/spatial/SDMWM.wfs?THEMATICMAPID={AoiSoilThematicMapID}&amp;TYPENAME=MapunitPolyThematic&amp;SERVICE=WFS&amp;VERSION=1.1.0&amp;REQUEST=GetFeature&amp;OUTPUTFORMAT=GML2!KNIL!'
							else null end"
							DisplayName="thematic data (Web Mercator)" DisplayEmptyValue="false" />
					</IdentifyAttributes>
				</Identify>	  
			  
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Soil Ratings: Soil ratings are an aggregated prediction of a map unit's suitabilities, limitations, properties, and qualities. The soil ratings of individual components are aggregated into one rating for a map unit based on defaults or user specified rules. The aggregated soil rating is then displayed on the soil map as a color that is defined in the legend and listed in reports." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
				  LAYER
				  Name '{~@LayerName}'
				  TYPE POLYGON
				  STATUS ON
				  {~$Projection.3857}
				  CONNECTIONTYPE PLUGIN
				  PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
				  CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
				  PROCESSING 'CLOSE_CONNECTION=DEFER'
				  DATA "AoiSoilMapUnitPolygonProj from (select projectedGeometry as AoiSoilMapUnitPolygonProj, id as AoiSoilMapunitPolygonId, RgbString, MapUnitSymbol, NationalMapUnitSymbol, fillOpacity = {Opacity} from AoiSoilThematicMapRating as ratings left join dbo.BAF_GetMappingPolygons_MapUnitPolygon({AoiID}, '{~^MapExtentProjectedWKT}', 3857, {MapunitPolygonDrawingStrategy_ThresholdFractionSsaAoi}, {MapunitPolygonDrawingStrategy_ThresholdFractionNonSsaAoi}) as base_table on ratings.MapUnitKey = base_table.MapUnitKey where ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} and ratings.AoiID = {AoiID} and ratings.MapUnitKey = base_table.MapUnitKey) as subqry using unique AoiSoilMapunitPolygonId using SRID=3857"
				  {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								{~? {Show National Mapunit Symbols}
								LabelItem 'NationalMapUnitSymbol'
						}
						{~? {~! {Show National Mapunit Symbols} }
								LabelItem 'MapUnitSymbol'
						}
					}
					class
					
							style
								OPACITY [fillOpacity]
								Color [RgbString]
							end # of style
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					label
					Color '{Label Color}'
					Outlinecolor '{Label Outline Color}'
					Outlinewidth {Label Outline Width}
					Font 'arial-bold'
					Position auto
					type truetype
					FORCE    {Force Labels}
					PARTIALS {Allow Partial Labels}
					PRIORITY {Label Priority}
					size {Label Size}
					end  #end of label
					{~? {Show Label Leaders}
					LEADER
					GRIDSTEP {Label Leader GRIDSTEP}
					MAXDISTANCE {Label Leader MAXDISTANCE}
					STYLE
					COLOR '{Label Leader Color}'
					WIDTH {Label Leader Width}
					END
					END # end of leader
					}
					}
					end  # of class
					END # end of layer '{~@LayerName}'

					LAYER
					Name '{~@LayerName}_outline'
					TYPE LINE
					STATUS ON
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'
					DATA "AoiSoilMapUnitPolygonProj from (select projectedGeometry as AoiSoilMapUnitPolygonProj, id as AoiSoilMapunitPolygonId, RgbString, MapUnitSymbol, NationalMapUnitSymbol, fillOpacity = {Opacity} from AoiSoilThematicMapRating as ratings left join dbo.BAF_GetMappingPolygons_MapUnitPolygon({AoiID}, '{~^MapExtentProjectedWKT}', 3857, {MapunitPolygonDrawingStrategy_ThresholdFractionSsaAoi}, {MapunitPolygonDrawingStrategy_ThresholdFractionNonSsaAoi}) as base_table on ratings.MapUnitKey = base_table.MapUnitKey where ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} and ratings.AoiID = {AoiID} and ratings.MapUnitKey = base_table.MapUnitKey) as subqry using unique AoiSoilMapunitPolygonId using SRID=3857"
					class
					{~? {~> {~^Indefinite Boundary Width} {Boundary Width} }
					style  # for the indefinite line
					WIDTH {~^Indefinite Boundary Width}
					Outlinecolor '{Boundary Color}'
						OPACITY {Indefinite Boundary Opacity}
					end # of style
					}
					style
						OPACITY {Outline Opacity}
					Width {Boundary Width}
					Outlinecolor '{Boundary Color}'
					end # of style
					end  # of class
					END # end of layer '{~@LayerName}_outline'
				</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="true" BoundaryColorMapAttributeName="Boundary Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupLine Name="Soil Rating Lines" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="17" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="true" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="AoiSoilThematicMapID" StringValue="0" IsEditable="false" MinValue="0" MaxValue="2147483647" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="9" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Color" Name="Line Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Not Rated Or Unavailable Color" StringValue="#dcdcdc" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="NameValue" Name="Outline Opacity" StringValue="100" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Rating Lines" DrawOrder="733" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="500000" AvailablilityTestType="None" SkipIfUnavailable="false">
				<Identify ConnectionKey="{~$ConnectionString.BafConnectionString}" 
					GeometryColumn="{~? {~! {AoiIsSSA} }AoiSoilMapUnitLineProj } {~? {AoiIsSSA} muLineproj }" 
					SRID="3857" 
					Source="{~? {~! {AoiIsSSA} } AoiSoilMapUnitLine as base_table with(nolock) left join AoiSoilThematicMapRating as ratings with(nolock) on (ratings.AoiID = base_table.AoiID and ratings.MapUnitKey = base_table.MapUnitKey) } {~? {AoiIsSSA} sdm.dbo.muLine as base_table with(index(SI_muline_24871)), sdm.dbo.mapunit as MU left join AoiSoilThematicMapRating as ratings with(nolock) on ratings.MapUnitKey = MU.mukey }"
					StatementRemainder="{~? {~! {AoiIsSSA} } AND base_table.AoiID={AoiID} and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} } {~? {AoiIsSSA} AND base_table.areasymbol='{AoiAreasymbol}' and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} and base_table.mukey = MU.mukey }"
				  >
					<IdentifyAttributes>
					  <LayerIdentifyAttribute 
						ColumnName="{~? {~! {AoiIsSSA} } ratings.MapUnitRatingString } {~? {AoiIsSSA} ratings.MapUnitRatingString }"
						DisplayName="Soil Ratings Value" DisplayEmptyValue="true" />
					  <LayerIdentifyAttribute
						ColumnName="{~? {~! {AoiIsSSA} } base_table.mapunitname } {~? {AoiIsSSA} MU.muname }"
						DisplayName="Map Unit Name" DisplayEmptyValue="false" />
					  <LayerIdentifyAttribute
						ColumnName="{~? {~! {AoiIsSSA} } base_table.mapunitsymbol } {~? {AoiIsSSA} base_table.musym }"
						DisplayName="Map Unit Symbol" DisplayEmptyValue="false" />
					  <LayerIdentifyAttribute
						ColumnName="{~? {~! {AoiIsSSA} } base_table.nationalmapunitsymbol } {~? {AoiIsSSA} base_table.nationalmusym }"
						DisplayName="National Map Unit Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
						ColumnName="case when {AoiSoilThematicMapID} > 0 then {AoiSoilThematicMapID} else null end"
						DisplayName="ThematicMapID" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
						ColumnName="case when '{AoiIsSSA}' = 'False' and {AoiSoilThematicMapID} > 0 then      
						'!LINK!https://{~$WebConfigSetting.SdaFqdn}/spatial/SDM.wms?THEMATICMAPID={AoiSoilThematicMapID}&amp;VERSION=1.1.1&amp;REQUEST=GetMap&amp;LAYERS=MapunitLineThematic&amp;SRS=EPSG:3857&amp;WIDTH={~^RasterSizeX}&amp;HEIGHT={~^RasterSizeY}&amp;FORMAT=image/png!KNIL!'
						else null end"
						DisplayName="thematic map (Web Mercator)" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
						ColumnName="case when '{AoiIsSSA}' = 'False' and {AoiSoilThematicMapID} > 0 then      
						'!LINK!https://{~$WebConfigSetting.SdaFqdn}/spatial/SDMWM.wfs?THEMATICMAPID={AoiSoilThematicMapID}&amp;TYPENAME=MapunitLineThematic&amp;SERVICE=WFS&amp;VERSION=1.1.0&amp;REQUEST=GetFeature&amp;OUTPUTFORMAT=GML2!KNIL!'
						else null end"
						DisplayName="thematic data (Web Mercator)" DisplayEmptyValue="false" />
					</IdentifyAttributes>
				</Identify>	
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Soil Ratings: Soil ratings are an aggregated prediction of a map unit's suitabilities, limitations, properties, and qualities. The soil ratings of individual components are aggregated into one rating for a map unit based on defaults or user specified rules. The aggregated soil rating is then displayed on the soil map as a color that is defined in the legend and listed in reports." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
				  LAYER
				  NAME '{~@LayerName}'
				  STATUS ON
				  {~$Projection.3857}
				  CONNECTIONTYPE PLUGIN
				  PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
				  CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
				  PROCESSING 'CLOSE_CONNECTION=DEFER'

				  DATA "AoiSoilMapunitLineProj from (
				  {~? {~! {AoiIsSSA} }
				  select AoiSoilMapUnitLineProj, MapUnitSymbol,
				  NationalMapUnitSymbol, base_table.MapUnitKey,
				  AoiSoilMapunitLineId, RgbString
				  from AoiSoilMapUnitLine as base_table,
				  AoiSoilThematicMapRating as ratings
				  where base_table.AoiID={AoiID}
				  and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID}
				  and ratings.AoiID = {AoiID}
				  and ratings.MapUnitKey = base_table.MapUnitKey
				  }
				  {~? {AoiIsSSA}
				  select muLineproj as AoiSoilMapUnitLineProj, musym as MapUnitSymbol,
				  nationalmusym as NationalMapUnitSymbol, base_table.mukey as MapUnitKey,
				  muLinekey as AoiSoilMapunitLineId, RgbString
				  from sdm.dbo.muLine as base_table with(index(SI_muline_24871)),
				  AoiSoilThematicMapRating as ratings
				  where base_table.muLineproj is not null
				  and base_table.areasymbol='{AoiAreasymbol}'
				  and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID}
				  and ratings.AoiID = {AoiID}
				  and ratings.MapUnitKey  = base_table.mukey
				  }
				  ) as subqry using unique AoiSoilMapunitLineId using SRID=3857"
				  
				  TYPE LINE
				  {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					{~? {Show National Mapunit Symbols}
					LabelItem 'NationalMapUnitSymbol'
					}
					{~? {~! {Show National Mapunit Symbols} }
					LabelItem 'MapUnitSymbol'
					}
					}
					CLASS
					{~? {~> {~^Indefinite Boundary Width} {Line Width} }
					style  # for the indefinite line
					WIDTH {~^Indefinite Boundary Width}
					color [RgbString]
						opacity {Indefinite Boundary Opacity}
					end # of style
					STYLE #black dashed line indefinite
					WIDTH {~^Indefinite Boundary Width}
					COLOR '#000000'
					PATTERN 1 8 END
						opacity {Indefinite Boundary Opacity}
					END # end of STYLE
					}
					STYLE
					WIDTH {Line Width}
					COLOR [RgbString]
					END

					STYLE #black dashed line
					WIDTH {Line Width}
					COLOR '#000000'
					PATTERN 1 8 END
					END # end of STYLE

					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								# the line-following label details, all experimental
								BUFFER 14           # nominal 1/5 inch separation between labels
								REPEATDISTANCE 280  # nominal 4 inch line distance
								ANGLE FOLLOW
								MAXOVERLAPANGLE 22.5
								MINFEATURESIZE auto
								end  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="true">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="SoilMapUnitLine.png" Text="Soil Map Unit Lines" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupPoint Name="Soil Rating Points" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="16" MapLayerType="Point" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedInteger" Name="Symbol Size" StringValue="6" IsEditable="true" MinValue="5" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="AoiSoilThematicMapID" StringValue="0" IsEditable="false" MinValue="0" MaxValue="2147483647" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ff8000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="9" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Color" Name="Not Rated Or Unavailable Color" StringValue="#dcdcdc" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="NameValue" Name="Outline Opacity" StringValue="100" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Soil Rating Points" DrawOrder="735" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="500000" AvailablilityTestType="None" SkipIfUnavailable="false">
				<Identify ConnectionKey="{~$ConnectionString.BafConnectionString}" 
					GeometryColumn="{~? {~! {AoiIsSSA} }AoiSoilMapUnitPointProj } {~? {AoiIsSSA} muPointproj }" 
					SRID="3857" 
					Source="{~? {~! {AoiIsSSA} } AoiSoilMapUnitPoint as base_table with(nolock) left join AoiSoilThematicMapRating as ratings with(nolock) on (ratings.AoiID = base_table.AoiID and ratings.MapUnitKey = base_table.MapUnitKey) } {~? {AoiIsSSA} sdm.dbo.muPoint as base_table with(index(SI_mupoint_24874)), sdm.dbo.mapunit as MU left join AoiSoilThematicMapRating as ratings with(nolock) on ratings.MapUnitKey = MU.mukey }"
					StatementRemainder="{~? {~! {AoiIsSSA} } AND base_table.AoiID={AoiID} and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} } {~? {AoiIsSSA} AND base_table.areasymbol='{AoiAreasymbol}' and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID} and base_table.mukey = MU.mukey }"
				  >
					<IdentifyAttributes>
					  <LayerIdentifyAttribute 
						ColumnName="{~? {~! {AoiIsSSA} } ratings.MapUnitRatingString } {~? {AoiIsSSA} ratings.MapUnitRatingString }"
						DisplayName="Soil Ratings Value" DisplayEmptyValue="true" />
					  <LayerIdentifyAttribute
						ColumnName="{~? {~! {AoiIsSSA} } base_table.mapunitname } {~? {AoiIsSSA} MU.muname }"
						DisplayName="Map Unit Name" DisplayEmptyValue="false" />
					  <LayerIdentifyAttribute
						ColumnName="{~? {~! {AoiIsSSA} } base_table.mapunitsymbol } {~? {AoiIsSSA} base_table.musym }"
						DisplayName="Map Unit Symbol" DisplayEmptyValue="false" />
					  <LayerIdentifyAttribute
						ColumnName="{~? {~! {AoiIsSSA} } base_table.nationalmapunitsymbol } {~? {AoiIsSSA} base_table.nationalmusym }"
						DisplayName="National Map Unit Symbol" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
						ColumnName="case when {AoiSoilThematicMapID} > 0 then {AoiSoilThematicMapID} else null end"
						DisplayName="ThematicMapID" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
						ColumnName="case when '{AoiIsSSA}' = 'False' and {AoiSoilThematicMapID} > 0 then      
						'!LINK!https://{~$WebConfigSetting.SdaFqdn}/spatial/SDM.wms?THEMATICMAPID={AoiSoilThematicMapID}&amp;VERSION=1.1.1&amp;REQUEST=GetMap&amp;LAYERS=MapunitPointThematic&amp;SRS=EPSG:3857&amp;WIDTH={~^RasterSizeX}&amp;HEIGHT={~^RasterSizeY}&amp;FORMAT=image/png!KNIL!'
						else null end"
						DisplayName="thematic map (Web Mercator)" DisplayEmptyValue="false" />
						<LayerIdentifyAttribute
						ColumnName="case when '{AoiIsSSA}' = 'False' and {AoiSoilThematicMapID} > 0 then      
						'!LINK!https://{~$WebConfigSetting.SdaFqdn}/spatial/SDMWM.wfs?THEMATICMAPID={AoiSoilThematicMapID}&amp;TYPENAME=MapunitPointThematic&amp;SERVICE=WFS&amp;VERSION=1.1.0&amp;REQUEST=GetFeature&amp;OUTPUTFORMAT=GML2!KNIL!'
						else null end"
						DisplayName="thematic data (Web Mercator)" DisplayEmptyValue="false" />
					</IdentifyAttributes>
				</Identify>	
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Soil Ratings: Soil ratings are an aggregated prediction of a map unit's suitabilities, limitations, properties, and qualities. The soil ratings of individual components are aggregated into one rating for a map unit based on defaults or user specified rules. The aggregated soil rating is then displayed on the soil map as a color that is defined in the legend and listed in reports." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
				  LAYER
				  NAME '{~@LayerName}'
				  STATUS ON
				  {~$Projection.3857}
				  CONNECTIONTYPE PLUGIN
				  PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
				  CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
				  PROCESSING 'CLOSE_CONNECTION=DEFER'

				  DATA "AoiSoilMapunitPointProj from (
				  {~? {~! {AoiIsSSA} }
				  select AoiSoilMapUnitPointProj, MapUnitSymbol,
				  NationalMapUnitSymbol, base_table.MapUnitKey,
				  AoiSoilMapunitPointId, RgbString
				  from AoiSoilMapUnitPoint as base_table,
				  AoiSoilThematicMapRating as ratings
				  where base_table.AoiID={AoiID}
				  and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID}
				  and ratings.AoiID = {AoiID}
				  and ratings.MapUnitKey = base_table.MapUnitKey
				  }
				  {~? {AoiIsSSA}
				  select mupointproj as AoiSoilMapUnitPointProj, musym as MapUnitSymbol,
				  nationalmusym as NationalMapUnitSymbol, base_table.mukey as MapUnitKey,
				  mupointkey as AoiSoilMapunitPointId, RgbString
				  from sdm.dbo.mupoint as base_table with(index(SI_mupoint_24874)),
				  AoiSoilThematicMapRating as ratings
				  where base_table.mupointproj is not null
				  and base_table.areasymbol='{AoiAreasymbol}'
				  and ratings.AoiSoilThematicMapID = {AoiSoilThematicMapID}
				  and ratings.AoiID = {AoiID}
				  and ratings.MapUnitKey = base_table.mukey
				  }
				  ) as subqry using unique AoiSoilMapunitPointId using SRID=3857"

				  TYPE POINT
				  {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					{~? {Show National Mapunit Symbols}
					LabelItem 'NationalMapUnitSymbol'
					}
					{~? {~! {Show National Mapunit Symbols} }
					LabelItem 'MapUnitSymbol'
					}
					}
					CLASS

					{~? {~> {~^Indefinite Boundary Width} {Symbol Size} }
					style
					symbol 'circle'
					size {~^Indefinite Boundary Width}
						opacity {Indefinite Boundary Opacity}
					color [RgbString]
					OutlineColor '{Boundary Color}'
					OutlineWidth {Boundary Width}
					end
					}

					style
					color [RgbString]
					OutlineColor '{Boundary Color}'
					OutlineWidth {Boundary Width}
					size {Symbol Size}
					symbol 'map unit point'
					end
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position uc
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								OFFSET 0 2
								end  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="true">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="SoilMapUnitPoint.png" Text="Soil Map Unit Points" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPoint>
		<MapLayerGroupPoint Name="Special Point Features" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="5" MapLayerType="Point" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="EnumeratedChoice" Name="Size" StringValue="8" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="6" />
			  <ChoiceList Name="Medium" Value="8" />
			  <ChoiceList Name="Large" Value="10" />
			  <ChoiceList Name="Very Large" Value="12" />
			</MapAttribute>
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="6" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="0" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Special Point Features" DrawOrder="713" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.SdmConnectionString}" GeometryColumn="featpointproj" SRID="3857" Source="featpoint as base_table left join featdesc on (base_table.FEATKEY = featdesc.featkey)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="FEATDESC.FEATNAME" DisplayName="Feature Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="base_table.FEATSYM" DisplayName="Feature Symbol" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="base_table.FEATKEY" DisplayName="Feature Key" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="base_table.AREASYMBOL" DisplayName="Area Symbol" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Special Point Features: Special point features on a soil map show many natural and cultural features other than soil map units and their boundaries. They identify areas of soils or miscellaneous areas that are too small to be delineated at the scale of mapping." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
					LAYER
					Name '{~@LayerName}'
					TYPE POINT
					STATUS on
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'

					DATA "AoiSoilSpotFeaturePointProj from (
					{~? {~! {AoiIsSSA} }
					select AoiSoilSpotFeaturePointProj, AoiSoilSpotFeaturePointID, MarkerCharacter from AoiSoilSpotFeaturePoint where AoiID={AoiID}
					}
					{~? {AoiIsSSA}
					select featpointproj as AoiSoilSpotFeaturePointProj, featpointkey as AoiSoilSpotFeaturePointID, MarkerCharacter
					from sdm.dbo.featpoint with(index(SI_featpoint_24868)) where featpointproj is not null and areasymbol='{AoiAreasymbol}'
					}
					) as subqry using unique AoiSoilSpotFeaturePointID using SRID=3857"

					composite OPACITY {Opacity} end
					LabelItem 'MarkerCharacter'

					class # 'specific symbols'
					# All characters except space (for 'none of the above')
					# are shown with the NRCS SSURGO font.
					expression ('[MarkerCharacter]' ne ' ')
					style # dummy point marker style or indefinite boundary
					{~? {~! {~> {~^Indefinite Boundary Width} {Size} } }
					width 0
					color '#ffffff'
					}
					{~? {~> {~^Indefinite Boundary Width} {Size} }
					symbol 'circle'
					size {~^Indefinite Boundary Width}
						opacity {Indefinite Boundary Opacity}
					color '{Label Color}'
					Outlinecolor '{Label Outline Color}'
					Outlinewidth {Label Outline Width}
					}
					end # end of style for dummy point marker style or indefinite boundary

					label
					Color '{Label Color}'
					Outlinecolor '{Label Outline Color}'
					Outlinewidth {Label Outline Width}
					Font 'nrcs-ssurgo'
					Position cc
					type truetype
					BUFFER {Buffer}
					PRIORITY {Label Priority}
					size {Size}
					FORCE    {Force Labels}
					PARTIALS {Allow Partial Labels}
					end  #end of label
					end  # of class 'specific symbols'

					class # 'other points'
					# All characters except space (for 'none of the above')
					# are shown with the NRCS SSURGO font.
					expression ('[MarkerCharacter]' eq ' ')
					{~? {~> {~^Indefinite Boundary Width} {Size} }
					style # indefinite boundary
					symbol 'circle'
					size {~^Indefinite Boundary Width}
						opacity {Indefinite Boundary Opacity}
					color '{Label Color}'
					Outlinecolor '{Label Outline Color}'
					Outlinewidth {Label Outline Width}
					end # end of style for indefinite boundary
					}
					style
					symbol 'triangle'
					size {Size}
					color '{Label Color}'
					outlinecolor '{Label Outline Color}'
					Outlinewidth {Label Outline Width}
					end # of style
					end  # of class 'other points'
					END  #end of layer '{~@LayerName}'
				</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Blowout.png" Text="Blowout" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Borrow_Pit.png" Text="Borrow Pit" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Clay_Spot.png" Text="Clay Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Depression_closed.png" Text="Closed Depression" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Gravel_Pit.png" Text="Gravel Pit" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Gravelly_Spot.png" Text="Gravelly Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Landfill.png" Text="Landfill" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Lava_Flow.png" Text="Lava Flow" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Marsh.png" Text="Marsh or swamp" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Mine_or_Quarry.png" Text="Mine or Quarry" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Miscellaneous_Water.png" Text="Miscellaneous Water" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Perennial_Water.png" Text="Perennial Water" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Rock_Outcrop.png" Text="Rock Outcrop" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Saline_Spot.png" Text="Saline Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Sandy_Spot.png" Text="Sandy Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Severely_Eroded_Spot.png" Text="Severely Eroded Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Sinkhole.png" Text="Sinkhole" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Slide_or_Slip.png" Text="Slide or Slip" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Sodic_Spot.png" Text="Sodic Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Spoil_Area.png" Text="Spoil Area" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Stony_Spot.png" Text="Stony Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Very_Stony_Spot.png" Text="Very Stony Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Wet_Spot.png" Text="Wet Spot" />
			  <FilenameTextAttributenameComparisonvalueTuple FileName="OtherPoint.png" Text="Other" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPoint>
		<MapLayerGroupLine Name="Special Line Features" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="6" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="false">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="true" MinValue="" MaxValue="">
			  <ChoiceList Name="Small" Value="5.5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="8.5" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="true" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Color" Name="Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="5" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="6" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Indefinite Boundary Opacity" StringValue="30" IsEditable="true" MinValue="0" MaxValue="100" />
			</MapAttributes>
		  <MapModes>
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Special Line Features" DrawOrder="703" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="50000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.SdmConnectionString}" GeometryColumn="featlineproj" SRID="3857" Source="featline as base_table left join featdesc on (base_table.FEATKEY = FEATDESC.featkey)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="FEATDESC.FEATNAME" DisplayName="Feature Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="base_table.FEATSYM" DisplayName="Feature Symbol" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="base_table.FEATKEY" DisplayName="Feature Key" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="base_table.AREASYMBOL" DisplayName="Area Symbol" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Special Line Features: Special line features on a soil map identify some linear areas of soils or miscellaneous areas that are too small to be delineated at the scale of mapping." />
					<LayerDescription Name="Supplier" Value="USDA NRCS Web Soil Survey https://websoilsurvey.sc.egov.usda.gov/" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								Name '{~@LayerName}'
								TYPE LINE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					LabelItem 'SoilSpotFeatureSymbol'
					}
					STATUS on
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.BafConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'

					DATA "AoiSoilSpotFeatureLineProj from (
					{~? {~! {AoiIsSSA} }
					select AoiSoilSpotFeatureLineProj, AoiSoilSpotFeatureLineID, SoilSpotFeatureSymbol from AoiSoilSpotFeatureLine where AoiID='{AoiID}'
					}
					{~? {AoiIsSSA}
					select featlineproj as AoiSoilSpotFeatureLineProj, featlinekey as AoiSoilSpotFeatureLineID, featsym as SoilSpotFeatureSymbol
					from sdm.dbo.featLine with(index(SI_featline_24865)) where featlineproj is not null and areasymbol='{AoiAreasymbol}'
					}
					) as subqry using unique AoiSoilSpotFeatureLineID using SRID=3857"

					class
					{~? {~> {~^Indefinite Boundary Width} {Line Width} }
					style  # for the indefinite line
					WIDTH {~^Indefinite Boundary Width}
					COLOR '#000000'
						opacity {Indefinite Boundary Opacity}
					end # of style
					}
					STYLE
					#black background
					WIDTH {Line Width}
					COLOR '#000000'
					END
					style
					pattern 1.0 5.0 10.0 5.0 END   # on/off distances
					# symbol 'dashed_line_5_5'
					width {Line Width}
					color '{Color}'
					end
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								# the line-following label details, all experimental
								BUFFER 14           # nominal 1/5 inch separation between labels
								REPEATDISTANCE 280  # nominal 4 inch line distance
								ANGLE FOLLOW
								MAXOVERLAPANGLE 22.5
								MINFEATURESIZE auto
								end  #end of label
								}
								end  # of class for other
								END  #end of layer '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="SpecialLineFeature.png" Text="Special Line Features" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
	<LegendCategory Name="Political Features" AreLayerGroupsMutuallyExclusive="false">
	  <MapLayerGroups>
		<MapLayerGroupPolygon Name="States" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="8" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="2" IsEditable="false" MinValue="0.2" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="8" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="6" />
			  <ChoiceList Name="Medium" Value="8" />
			  <ChoiceList Name="Large" Value="10" />
			  <ChoiceList Name="Very Large" Value="12" />
			</MapAttribute>
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#EEEEEE" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="80" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="5" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="0" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="States" DrawOrder="123" MinScaleDenom="2000000" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.STATES_A_UST_GEN_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="STATENAME" DisplayName="State Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="STPO" DisplayName="State Abbreviation" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="FIPS_C" DisplayName="State FIPS Code" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Generalized State Boundaries" />
					<LayerDescription Name="Supplier" Value="USDA NRCS" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from base.STATES_A_UST_GEN_WM as base_table with(nolock, INDEX(S14_idx)) using unique OBJECTID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE POLYGON
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
	LAYER
		NAME '{~@LayerName}-annotation'
		STATUS ON
		{~$Projection.3857}
		CONNECTIONTYPE PLUGIN
		PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
		CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
		PROCESSING 'CLOSE_CONNECTION=DEFER'
		DATA 'Shape from base.STATES_A_UST_GEN_WM as base_table with(nolock, INDEX(S14_idx)) using unique OBJECTID using SRID=3857'
		PROCESSING "NATIVE_FILTER=
			objectid in
			(select Areas.OBJECTID
			from
			(Select
			base_table.OBJECTID,
			base_table.STPO,
			base_table.Shape.STArea() G_Area,
			rank()
			over
			(partition by STPO
			order by sum(Shape.STArea()) desc) Area_Rank
			from base.STATES_A_UST_GEN_WM as base_table
			where Shape.STIntersects(
			geometry::STGeomFromText('{~^MapExtentProjectedWKT}',3857)) = 1
			group by
			base_table.OBJECTID,
			base_table.STPO,
			base_table.Shape.STArea()) Areas
			where Areas.Area_Rank = 1)"
		composite OPACITY {Opacity} end
		TYPE POLYGON
		LabelItem 'STPO'
		CLASS
			label
				Color '{Label Color}'
				Outlinecolor '{Label Outline Color}'
				Outlinewidth {Label Outline Width}
				Font 'arial-bold'
				Position auto
				type truetype
				size {Label Size}
				PRIORITY {Label Priority}
				BUFFER {Buffer}
				FORCE    {Force Labels}
				PARTIALS {Allow Partial Labels}
			end  #end of label
			STYLE
				WIDTH 0
			END # end of style
		END # end of CLASS
	END # end of LAYER '{~@LayerName}-annotation'
								}
							</MapServerLayerTemplateText>
			</Layer>
			<Layer Name="Detailed States" DrawOrder="124" MinScaleDenom="0" MaxScaleDenom="2000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.STATES_A_UST_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="STATENAME" DisplayName="State Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="STPO" DisplayName="State Abbreviation" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="FIPS_C" DisplayName="State FIPS Code" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="State Boundaries" />
					<LayerDescription Name="Supplier" Value="USDA NRCS" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from (select Shape, OBJECTID , STPO from base.STATES_A_UST_WM as base_table with(nolock, INDEX(S19_idx))) as subqry using unique OBJECTID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE POLYGON
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Counties" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="10" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="4000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#CCCCCC" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="0.2" MaxValue="3" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="20" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#DDDDDD" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="5" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="8" IsEditable="false" MinValue="1" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="y Offset" StringValue="0" IsEditable="false" MinValue="-100" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="80" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Counties" DrawOrder="120" MinScaleDenom="100000" MaxScaleDenom="4000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.CNTY_A_UST_GEN_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="COUNTYNAME" DisplayName="County Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="FIPS_C" DisplayName="FIPS Code" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="STATENAME" DisplayName="State Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Generalized County Boundaries" />
					<LayerDescription Name="Supplier" Value="USDA NRCS" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from base.CNTY_A_UST_GEN_WM as base_table with(nolock, INDEX(S28_idx)) using unique ObjectID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'COUNTYNAME'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold-italic'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								OFFSET 0 {y Offset}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
			<Layer Name="Detailed Counties" DrawOrder="121" MinScaleDenom="0" MaxScaleDenom="100000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.CNTY_A_UST_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="COUNTYNAME" DisplayName="County Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="FIPS_C" DisplayName="FIPS Code" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="STATENAME" DisplayName="State Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="County Boundaries" />
					<LayerDescription Name="Supplier" Value="USDA NRCS" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from base.CNTY_A_UST_WM as base_table with(nolock) using unique OBJECTID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'COUNTYNAME'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~? {Show Labels}
								label
								Color '{Label Color}'
								Font 'arial-bold-italic'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								OFFSET 0 {y Offset}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								end  #end of label
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Urban Areas" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="15" MapLayerType="Polygon" MinScaleDenom="100000" MaxScaleDenom="2000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#808080" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Urban Areas" DrawOrder="125" MinScaleDenom="100000" MaxScaleDenom="2000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.urban_areas_TIGER_a_us_2010_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME10" DisplayName="Place Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Urban Areas" />
					<LayerDescription Name="Supplier" Value="US Census" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from (select Shape, objectID, NAME10 from base.urban_areas_TIGER_a_us_2010_wm as base_table with(nolock) ) as subqry using unique objectID using SRID=3857'
								TYPE POLYGON
								composite OPACITY {Opacity} end
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END
								STYLE
								SYMBOL 'hatch'
								COLOR '{Boundary Color}'
								ANGLE 0
								WIDTH 1
								SIZE 6
								END
								STYLE
								SYMBOL 'hatch'
								COLOR '{Boundary Color}'
								ANGLE 90
								WIDTH 1
								SIZE 6
								END
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Urban_Areas.png" Text="Urban Areas" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPolygon>
		<MapLayerGroupPoint Name="Cities" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="12" MapLayerType="Point" MinScaleDenom="0" MaxScaleDenom="1500000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0.7" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			  <MapAttribute AttributeType="ClampedDouble" Name="City Population Small" StringValue="10000" IsEditable="false" MinValue="0" MaxValue="10000000" />
			  <MapAttribute AttributeType="ClampedDouble" Name="City Population Medium" StringValue="2000000" IsEditable="false" MinValue="0" MaxValue="10000000" />
			  <MapAttribute AttributeType="ClampedDouble" Name="Label Size Small" StringValue="6" IsEditable="false" MinValue="1" MaxValue="100" />
			  <MapAttribute AttributeType="ClampedDouble" Name="Label Size Medium" StringValue="7" IsEditable="false" MinValue="1" MaxValue="100" />
			  <MapAttribute AttributeType="ClampedDouble" Name="Label Size Large" StringValue="8" IsEditable="false" MinValue="1" MaxValue="100" />
			  <MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#003300" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			  <MapAttribute AttributeType="ClampedDouble" Name="Label Priority Small" StringValue="3" IsEditable="false" MinValue="0" MaxValue="100" />
			  <MapAttribute AttributeType="ClampedDouble" Name="Label Priority Medium" StringValue="4" IsEditable="false" MinValue="0" MaxValue="100" />
			  <MapAttribute AttributeType="ClampedDouble" Name="Label Priority Large" StringValue="5" IsEditable="false" MinValue="0" MaxValue="100" />
			  <MapAttribute AttributeType="Color" Name="Circle Color" StringValue="#007700" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Circle Size" StringValue="5" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Cities" DrawOrder="600" MinScaleDenom="0" MaxScaleDenom="1500000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.CITIESX020_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME" DisplayName="City" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="STATE" DisplayName="State Abbreviation" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Cities" />
					<LayerDescription Name="Supplier" Value="US Census" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
				<MapServerLayerTemplateText>
					LAYER
					NAME '{~@LayerName}'
					STATUS ON
					{~$Projection.3857}
					CONNECTIONTYPE PLUGIN
					PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
					CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
					PROCESSING 'CLOSE_CONNECTION=DEFER'
					DATA "Shape from base.wss_GetCitiesMapLayerData({City Population Small}, {City Population Medium}, {Label Size Small}, {Label Size Medium}, {Label Size Large}, {Label Priority Small}, {Label Priority Medium}, {Label Priority Large}, '{~^MapExtentProjectedWKT}', 3857) using unique objectID using SRID=3857"
					TYPE POINT
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					LABELITEM 'NAME'
					}
					composite OPACITY {Opacity} end
					CLASS
					style
					color '{Circle Color}'
					outlinecolor '{Boundary Color}'
					outlinewidth {Boundary Width}
					size {Circle Size}
					symbol 'circle'
					end
					{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
					label
					Color '{Label Color}'
					Font 'arial-bold'
					size [LabelSize]
					buffer {Buffer}
					OutlineColor '{Label Outline Color}'
					OutlineWidth {Label Outline Width}
					Position uc
					OFFSET 0 1
					type truetype
					PRIORITY [LabelPriority]
					FORCE    {Force Labels}
					PARTIALS {Allow Partial Labels}
					end  #end of label
					}
					END # end of CLASS
					END # end of LAYER '{~@LayerName}'
				</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Cities.png" Text="Cities" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupPoint>
		<MapLayerGroupPolygon Name="Postal Code" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="11" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="2000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#00cc33" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#00CC33" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="60" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="2" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Postal Code" DrawOrder="130" MinScaleDenom="0" MaxScaleDenom="2000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.ZIP_CODES_A_UST_2010_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="ZIP" DisplayName="Zip Code" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Zip Code Boundaries" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from (select Shape, objectID, zip from base.ZIP_CODES_A_UST_2010_wm as base_table with(nolock)) as subqry using unique objectID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'ZIP'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								BUFFER {Buffer}
								PRIORITY {Label Priority}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="PLSS Township and Range" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="9" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="600000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="2" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#1e1e1e" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#1e1e1e" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="60" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="5" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Township and Range" DrawOrder="400" MinScaleDenom="0" MaxScaleDenom="600000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.PLSS_BLM_2011_Townships_wm with(nolock)" StatementRemainder="AND [primer] is not null and [label] is not null">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="label" DisplayName="Township and Range" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="state" DisplayName="State" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Public Land Survey System - Townships" />
					<LayerDescription Name="Supplier" Value="Bureau of Land Management" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "Shape from (select Shape, ObjectID , label from base.PLSS_BLM_2011_Townships_wm as base_table with(nolock, INDEX(S44_idx)) where [primer] is not null and [label] is not null ) as subqry using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'label'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								BUFFER {Buffer}
								PRIORITY {Label Priority}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="PLSS Section" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="7" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="300000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#1e1e1e" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="6" IsEditable="false" MinValue="1" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="60" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Section" DrawOrder="410" MinScaleDenom="0" MaxScaleDenom="300000" LabelMinScaleDenom="0" LabelMaxScaleDenom="100000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.PLSS_BLM_2011_Sections_wm with(nolock)" StatementRemainder="AND [label] is not null">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="label" DisplayName="Section" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "Shape from (select Shape, ObjectID , label from base.PLSS_BLM_2011_Sections_wm as base_table with(nolock) where [label] is not null ) as subqry using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'label'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								BUFFER {Buffer}
								PRIORITY {Label Priority}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
		<LegendCategory Name="Federal Land" AreLayerGroupsMutuallyExclusive="false">
			<MapLayerGroups>
				<MapLayerGroupPolygon Name="BIA" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="99" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
					<MapAttributes>
						<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#CD0000" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1.0" IsEditable="false"  MinValue="0" MaxValue="3" />
						<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#000000" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false"  MinValue="1" MaxValue="20" />
						<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#BBBB00" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false"  MinValue="1" MaxValue="3" />
						<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="50" IsEditable="false"  MinValue="20" MaxValue="100" />
						<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false"  MinValue="1" MaxValue="10" />
						<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false"  MinValue="0" MaxValue="100" />
						<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false"  MinValue="1" MaxValue="20" />
						<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false"  MinValue="5" MaxValue="100" />
						<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false"  MinValue="1" MaxValue="5" />
						<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false"  MinValue="" MaxValue="" />
						<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false"  MinValue="" MaxValue="" />
					</MapAttributes>
					<MapModes>
						<MapMode Name="Area of Interest" VisibleByDefault="false" />
						<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
						<MapMode Name="Report Cover Map" VisibleByDefault="false" />
					</MapModes>
					<MapLayers>
						<Layer Name="BIA" DrawOrder="349" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
							<Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="4326" Source="base.INDIANRES_TIGER_A_US_2015 with(nolock)">
								<IdentifyAttributes>
									<LayerIdentifyAttribute ColumnName="NAMELSAD" DisplayName="Tribal Subdivision" DisplayEmptyValue="false" />
								</IdentifyAttributes>
							</Identify>
							<MapLayerDescriptionGroups>
								<LayerDescriptionGroup Name="Data Source">
									<MapLayerDescriptions>
										<LayerDescription Name="Description" Value="American Indian reservations and off-reservation trust lands." />
										<LayerDescription Name="Supplier" Value="U.S. Census Bureau. Jan. 2015" />
									</MapLayerDescriptions>
								</LayerDescriptionGroup>
							</MapLayerDescriptionGroups>
							<MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.4326}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.INDIANRES_TIGER_A_US_2015 as base_table with(nolock) using unique ObjectID using SRID=4326"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'NAMELSAD'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}AoiSoilSpotFeatureLineProj
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
						</Layer>
					</MapLayers>
					<MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
				</MapLayerGroupPolygon>
				<MapLayerGroupPolygon Name="Bureau of Land Management" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="21" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000"  CanUseClientSideImage="true">
					<MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#501450" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="6" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ffffff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#501450" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="10" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="BLM" DrawOrder="350" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="6500000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_BLM_ADMIN_DSLVD_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="STATEOFFIC" DisplayName="State Office" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="BLMNM" DisplayName="Field Office" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.FEDERALLANDS_BLM_ADMIN_DSLVD_wm as base_table with(nolock, INDEX(S69_idx)) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'BLMNM'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'

							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Bureau of Reclamation" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="24" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#800000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#800000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#800000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="40" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="BOR" DrawOrder="351" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_BOR_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME1" DisplayName="Bureau of Reclamation Unit" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.FEDERALLANDS_BOR_wm as base_table with(nolock) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'NAME1'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Department of Defense" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="20" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#FF4500" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#FF4500" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#D2691E" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="20" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="DOD" DrawOrder="352" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_DOD_ARMY_120406_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="INST_NAME" DisplayName="Installation" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.FEDERALLANDS_DOD_ARMY_120406_wm as base_table with(nolock, INDEX(S85_idx)) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'INST_NAME'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Fish and Wildlife Service" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="25" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#FFFF00" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#FFFF00" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#BBBB00" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="20" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="FWS" DrawOrder="353" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_FWS_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME1" DisplayName="Fish and Wildlife Service Unit" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="NAME2" DisplayName="Larger Boundary (if relevant)" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.FEDERALLANDS_FWS_wm as base_table with(nolock) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'NAME1'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}AoiSoilSpotFeatureLineProj
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Forest Service" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="22" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#37ff2a" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#37ff2a" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#008000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="20" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="FS" DrawOrder="354" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_FS_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME1" DisplayName="National Forest Unit" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="NAME2" DisplayName="Larger Boundary (if relevant)" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.FEDERALLANDS_FS_wm as base_table with(nolock, INDEX(S71_idx)) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'NAME1'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="National Park Service" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="19" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#ff80ff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#ff80ff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ffffff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#8B008B" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="20" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="NPS" DrawOrder="355" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_NPS_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="UNIT_NAME" DisplayName="Park Name" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="UNIT_TYPE" DisplayName="Park Type" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="UNIT_CODE" DisplayName="Park Code" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from (select SHAPE, ObjectID , UNIT_NAME + ' ' + UNIT_TYPE as labelText from base.FEDERALLANDS_NPS_wm as base_table with(nolock,INDEX(S73_idx))) as subqry using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'labelText'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupPolygon Name="Tennessee Valley Authority" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="26" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#900090" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#900090" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="0" MaxValue="20" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#ffffff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#700070" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="40" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="TVA" DrawOrder="356" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="2000000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.FEDERALLANDS_TVA_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME1" DisplayName="Tennessee Valley Authority Unit" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "SHAPE from base.FEDERALLANDS_TVA_wm as base_table with(nolock) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem 'NAME1'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
	<LegendCategory Name="Water Features" AreLayerGroupsMutuallyExclusive="false">
	  <MapLayerGroups>
		<MapLayerGroupPolygon Name="Oceans" HasLayerDescriptions="false" IsIdentifiable="false" MapLayerGroupId="28" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Fill Color" StringValue="#84c1ff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#84c1ff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="8" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="6" />
			  <ChoiceList Name="Medium" Value="8" />
			  <ChoiceList Name="Large" Value="10" />
			  <ChoiceList Name="Very Large" Value="12" />
			</MapAttribute>
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#ff0000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="3" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="World_Oceans_Generalized" DrawOrder="1" MinScaleDenom="2000000" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "Shape from base.WORLD_OCEAN_DETAILED_GEN500M_WM as base_table with(nolock) using unique OBJECTID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
			<Layer Name="World_Oceans_Detailed" DrawOrder="2" MinScaleDenom="0" MaxScaleDenom="2000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "Shape from base.WORLD_OCEAN_DETAILED_WM as base_table with(nolock) using unique OBJECTID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE POLYGON
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								COLOR '{Fill Color}'
								END # end of STYLE
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" FillColorMapAttributeName="Fill Color" OpacityMapAttributeName="Opacity" />
		</MapLayerGroupPolygon>
		<MapLayerGroupLine Name="Streams and Canals" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="13" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="125000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Color" Name="Line Color" StringValue="#84c1ff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Size" StringValue="7" IsEditable="false" MinValue="1" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#84c1ff" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="3" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Buffer" StringValue="14" IsEditable="false" MinValue="1" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Min Distance" StringValue="500" IsEditable="false" MinValue="1" MaxValue="1000" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Watercourses" DrawOrder="300" MinScaleDenom="0" MaxScaleDenom="125000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="SHAPE" SRID="3857" Source="base.NHDFLOWLINE_MEDIUM_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="GNIS_NAME" DisplayName="Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="National Hydrography Dataset - Flowline, Medium Resolution" />
					<LayerDescription Name="Supplier" Value="United States Geological Survey" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from base.NHDFLOWLINE_MEDIUM_wm as base_table with(nolock) using unique ObjectID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE LINE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'GNIS_NAME'
								}
								CLASS
								STYLE
								WIDTH {Line Width}
								COLOR '{Line Color}'
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold-italic'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								PRIORITY {Label Priority}
								MINDISTANCE {Min Distance}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								# the line-following label details, all experimental
								BUFFER {Buffer}           # nominal 1/5 inch separation between labels
								REPEATDISTANCE 280  # nominal 4 inch line distance
								ANGLE FOLLOW
								MAXOVERLAPANGLE 22.5
								MINFEATURESIZE auto
								end  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Hydrography.png" Text="Streams" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupPolygon Name="8-Digit Hydrologic Units" HasLayerDescriptions="false" IsIdentifiable="true" MapLayerGroupId="18" MapLayerType="Polygon" MinScaleDenom="0" MaxScaleDenom="3000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="ClampedDouble" Name="Boundary Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="Color" Name="Boundary Color" StringValue="#990099" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="6" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="6" />
			  <ChoiceList Name="Medium" Value="8" />
			  <ChoiceList Name="Large" Value="10" />
			  <ChoiceList Name="Very Large" Value="12" />
			</MapAttribute>
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#990099" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedDouble" Name="Buffer" StringValue="15" IsEditable="false" MinValue="0" MaxValue="100" />
			<MapAttribute AttributeType="Boolean" Name="Show Label Leaders" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader GRIDSTEP" StringValue="5" IsEditable="false" MinValue="1" MaxValue="20" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader MAXDISTANCE" StringValue="30" IsEditable="false" MinValue="5" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Label Leader Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Leader Width" StringValue="1" IsEditable="false" MinValue="1" MaxValue="5" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
						<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="8-Digit Hydrologic Units" DrawOrder="360" MinScaleDenom="0" MaxScaleDenom="3000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.HU8_Poly_wm with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="HUC_8" DisplayName="Hydrologic Unit (8 digit)" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="REGION" DisplayName="Region" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="SUBREGION" DisplayName="SubRegion" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="BASIN" DisplayName="Basin" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="SUBBASIN" DisplayName="SubBasin" DisplayEmptyValue="false" />
				  <LayerIdentifyAttribute ColumnName="case when ACRES is null then '' when ACRES &lt; 10.0 then ltrim(str(ACRES,30,2)) when ACRES &lt; 1000.0 then ltrim(str(ACRES,30,1)) else ltrim(substring(convert(char(30), cast(round(ACRES,0) as money), 1), 1, 27)) end" DisplayName="Acres" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups />
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA 'Shape from base.HU8_Poly_wm as base_table with(nolock) using unique ObjectID using SRID=3857'
								composite OPACITY {Opacity} end
								TYPE POLYGON
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'HUC_8'
								}
								CLASS
								STYLE
								OUTLINECOLOR '{Boundary Color}'
								WIDTH {Boundary Width}
								END # end of STYLE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								label
								Color '{Label Color}'
								Font 'arial-bold'
								Size {Label Size}
								OutlineColor '{Label Outline Color}'
								OutlineWidth {Label Outline Width}
								Position auto
								type truetype
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								BUFFER {Buffer}
								end  #end of label
								{~? {Show Label Leaders}
								LEADER
								GRIDSTEP {Label Leader GRIDSTEP}
								MAXDISTANCE {Label Leader MAXDISTANCE}
								STYLE
								COLOR '{Label Leader Color}'
								WIDTH {Label Leader Width}
								END
								END # end of leader
								}
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendColor IsDynamic="false" BoundaryColorMapAttributeName="Boundary Color" />
		</MapLayerGroupPolygon>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
	<LegendCategory Name="Transportation" AreLayerGroupsMutuallyExclusive="false">
	  <MapLayerGroups>
		<MapLayerGroupLine Name="Rails" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="14" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="200000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Color" Name="Rail Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Rail Size" StringValue="4" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Rail Gap" StringValue="-8" IsEditable="false" MinValue="-10" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Outline Width" StringValue="0.40" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Line Width" StringValue="0" IsEditable="false" MinValue="0" MaxValue="10" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Rails" DrawOrder="490" MinScaleDenom="0" MaxScaleDenom="200000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.RAILROADS_L_UST_2009_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME" DisplayName="Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Railroads" />
					<LayerDescription Name="Supplier" Value="US Census" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								SYMBOL
								NAME 'rail'
								TYPE TRUETYPE
								FONT arial
								CHARACTER '|'
								END

								LAYER
								NAME  '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "Shape from base.RAILROADS_L_UST_2009_WM as base_table with(nolock) using unique ObjectID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE LINE
								CLASS
								STYLE
								WIDTH {Line Width}
								OUTLINEWIDTH {Outline Width}
								OUTLINECOLOR '{Outline Color}'
								END
								STYLE
								SYMBOL rail
								SIZE {Rail Size}
								COLOR '{Rail Color}'
								GAP {Rail Gap}
								END
								END
								END # end of layer '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Rails.png" Text="Rails" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupLine Name="Interstate Highways" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="29" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="10000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="1" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Buffer" StringValue="10" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="Color" Name="Line Color" StringValue="#cc1a00" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="false" MinValue="0" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Min Distance" StringValue="500" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Outline Width" StringValue="0.5" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ClampedInteger" Name="Shield Bottom Size" StringValue="18" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedDouble" Name="Shield Top Size" StringValue="5" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedInteger" Name="Text Size" StringValue="5" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Interstate Highways" DrawOrder="530" MinScaleDenom="0" MaxScaleDenom="10000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
        <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="dbo.WSS_INTERSTATES_ESRI_HWY_L_UST_2009_WM with(nolock)">
        <IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="HWY_NUM" DisplayName="Route Number" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Interstate Highways" />
					<LayerDescription Name="Supplier" Value="ESRI, Inc." />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
          symbol
          NAME 'interstate_shield_top'
          TYPE vector
          POINTS
          0.2		8 # LL point
          0.4		6
          0.8		4
          1.5		2
          2		1 # UL point
          3.5		1.5
          5		1.8
          5.5		1.9
          6.5		2 # left side dip
          7.5		2 # left side dip
          8.5		1.9
          11		1.5
          12		1.2
          13.2	0.5
          14		0 # top point
          14.8	0.5
          16		1.2
          17		1.5
          19.5	1.9
          20.5	2 # right side dip
          21.5	2 # right side dip
          22.5	1.9
          23		1.8
          24.5	1.5
          26		1 # UR point
          26.5	2
          27.2	4
          27.6	6
          27.8	8 # LR point
          0.2		8 # LL point
          END
          filled true
          END

          symbol
          NAME 'interstate_shield_bottom'
          TYPE vector
          POINTS
          0.2		8
          27.8	8
          28		9
          28		12
          27.7	14
          27.1	16.8
          26.4	19
          25.2	21
          24.6	22
          23.2	24
          21.5	26
          19		28
          17		29
          14		30 # bottom point
          11		29
          9		28
          6.5		26
          4.8		24
          3.4		22
          2.8		21
          1.6		19
          0.9		16.8
          0.3		14
          0		12 #
          0		9
          0.1		8
          END
          filled true
          END
          }
          LAYER
          NAME '{~@LayerName}'
          STATUS ON
          composite OPACITY {Opacity} end
          TYPE LINE
          {~$Projection.3857}
          CONNECTIONTYPE PLUGIN
          PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
          CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
          PROCESSING 'CLOSE_CONNECTION=DEFER'
          DATA 'Shape from dbo.WSS_INTERSTATES_ESRI_HWY_L_UST_2009_WM as base_table with(nolock) using unique OBJECTID using SRID=3857'
          {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								labelitem HWY_NUM
								}
								CLASS
								STYLE
								COLOR '{Line Color}'
								WIDTH {Line Width}
								OUTLINECOLOR '{Outline Color}'
								OUTLINEWIDTH {Outline Width}
								END
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABEL
								STYLE
								SYMBOL 'interstate_shield_top'
								COLOR '#ED1C2D'
								OUTLINECOLOR '#FFFFFF'
								OUTLINEWIDTH 2
								SIZE {Shield Top Size}
								OFFSET 0 -6
								END
								STYLE
								SYMBOL 'interstate_shield_bottom'
								COLOR '#0022FF'
								OUTLINECOLOR '#FFFFFF'
								OUTLINEWIDTH 2
								SIZE {Shield Bottom Size}
								#OFFSET -1 0
								END
								# route number
								TYPE TRUETYPE
								FONT 'arial-bold'
								SIZE {Text Size}
								COLOR 255 255 255
								MINDISTANCE {Min Distance}
								ANTIALIAS TRUE
								OFFSET 0 1
								BUFFER {Buffer}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								END  # end of LABEL
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Interstate_Highways.png" Text="Interstate Highways" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupLine Name="US Routes" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="30" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="3000000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Offset X" StringValue="0" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedDouble" Name="Label Offset Y" StringValue="2" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="1" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Color" Name="Line Color" StringValue="#a07804" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="false" MinValue="0" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Outline Width" StringValue="0.4" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="ClampedDouble" Name="Shield Size" StringValue="19" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedDouble" Name="Shield Buffer" StringValue="10" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedInteger" Name="Min Distance" StringValue="200" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="US Routes" DrawOrder="520" MinScaleDenom="0" MaxScaleDenom="3000000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="dbo.WSS_US_ROUTES_ESRI_HWY_L_UST_2009_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="HWY_NUM" DisplayName="Route Number" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="US Highways" />
					<LayerDescription Name="Supplier" Value="ESRI, Inc." />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
          symbol
          NAME 'us_highway_shield_DNR'
          TYPE TRUETYPE
          FONT 'road_shields'
          filled true
          CHARACTER '-'
          end
          symbol
          # note: we need this background because the shield itself will not fill
          NAME 'us_highway_shield_DNR_background'
          TYPE vector
          POINTS
          8        1
          11       3
          13       3
          16       1
          20       3
          22       3
          24       1
          30       6
          28       10
          28       14
          30       18
          30       21
          27       25
          20       25
          17       27
          16       27
          13       25
          7        25
          3        21
          3        18
          5        14
          5        10
          3        6
          8        1
          END
          filled true
          END
          }
          LAYER
          NAME '{~@LayerName}'
          STATUS ON
          {~$Projection.3857}
          CONNECTIONTYPE PLUGIN
          PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
          CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
          PROCESSING 'CLOSE_CONNECTION=DEFER'
          DATA 'Shape from dbo.WSS_US_ROUTES_ESRI_HWY_L_UST_2009_WM as base_table with(nolock) using unique OBJECTID using SRID=3857'
          composite OPACITY {Opacity} end
          TYPE LINE
          {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'HWY_NUM'
								}
								CLASS
								STYLE
								COLOR '{Line Color}'
								WIDTH {Line Width}
								OUTLINECOLOR '{Outline Color}'
								OUTLINEWIDTH {Outline Width}
								END
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABEL
								STYLE  # background
								SYMBOL 'us_highway_shield_DNR_background'
								COLOR 255 255 255
								OUTLINECOLOR 0 0 0
								OUTLINEWIDTH 1
								OFFSET -1 0
								SIZE {Shield Size}
								END
								# route number
								MINDISTANCE {Min Distance}
								TYPE TRUETYPE
								FONT 'arial-bold'
								SIZE 5
								COLOR 0 0 0
								BUFFER {Shield Buffer}
								ANTIALIAS TRUE
								OFFSET {Label Offset X} {Label Offset Y}
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								END  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="US_Routes.png" Text="US Routes" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupLine Name="Major Roads" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="31" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="500000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Buffer" StringValue="10" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="1" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="7" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="5" />
			  <ChoiceList Name="Medium" Value="7" />
			  <ChoiceList Name="Large" Value="9" />
			  <ChoiceList Name="Very Large" Value="11" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="1" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Color" Name="Line Color" StringValue="#979164" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="false" MinValue="0" MaxValue="10" />
			<MapAttribute AttributeType="ClampedInteger" Name="Min Distance" StringValue="500" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Outline Width" StringValue="0.4" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Major Roads" DrawOrder="510" MinScaleDenom="0" MaxScaleDenom="500000" LabelMinScaleDenom="0" LabelMaxScaleDenom="24000" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="base.ESRI_MAJOR_ROADS_WM with(nolock)">
				<IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="NAME" DisplayName="Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Major Roads" />
					<LayerDescription Name="Supplier" Value="ESRI, Inc." />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
								LAYER
								NAME '{~@LayerName}'
								STATUS ON
								{~$Projection.3857}
								CONNECTIONTYPE PLUGIN
								PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
								CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
								PROCESSING 'CLOSE_CONNECTION=DEFER'
								DATA "Shape from base.ESRI_MAJOR_ROADS_WM as base_table with(nolock) using unique OBJECTID using SRID=3857"
								composite OPACITY {Opacity} end
								TYPE LINE
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'NAME'
								}
								CLASS
								STYLE
								COLOR '{Line Color}'
								WIDTH {Line Width}
								OUTLINECOLOR '{Outline Color}'
								OUTLINEWIDTH {Outline Width}
								END
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABEL
								COLOR '{Label Color}'
								FONT 'arial-bold'
								SIZE {Label Size}
								OUTLINECOLOR '{Label Outline Color}'
								OUTLINEWIDTH {Label Outline Width}
								POSITION AUTO
								MINDISTANCE {Min Distance}
								TYPE TRUETYPE
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								PRIORITY {Label Priority}
								# the line-following label details, all experimental
								BUFFER {Buffer}          # nominal 1/5 inch separation between labels
								REPEATDISTANCE 280  # nominal 4 inch line distance
								ANGLE FOLLOW
								MAXOVERLAPANGLE 22.5
								MINFEATURESIZE auto
								END  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="State_Highways.png" Text="Major Roads" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
		<MapLayerGroupLine Name="Local Roads" HasLayerDescriptions="true" IsIdentifiable="true" MapLayerGroupId="32" MapLayerType="Line" MinScaleDenom="0" MaxScaleDenom="24000" CanUseClientSideImage="true">
		  <MapAttributes>
			<MapAttribute AttributeType="Boolean" Name="Show Labels" StringValue="True" IsEditable="true" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Buffer" StringValue="30" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="Color" Name="Label Color" StringValue="#FFFFFF" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Color" Name="Label Outline Color" StringValue="#000000" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedInteger" Name="Label Outline Width" StringValue="2" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="EnumeratedChoice" Name="Label Size" StringValue="6" IsEditable="false" MinValue="" MaxValue="">
			  <ChoiceList Name="Tiny" Value="4" />
			  <ChoiceList Name="Medium" Value="6" />
			  <ChoiceList Name="Large" Value="8" />
			  <ChoiceList Name="Very Large" Value="10" />
			</MapAttribute>
			<MapAttribute AttributeType="ClampedInteger" Name="Label Priority" StringValue="1" IsEditable="false" MinValue="1" MaxValue="10" />
			<MapAttribute AttributeType="Color" Name="Line Color" StringValue="#a0a0a0" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Line Width" StringValue="2" IsEditable="false" MinValue="0" MaxValue="610" />
			<MapAttribute AttributeType="ClampedInteger" Name="Min Distance" StringValue="500" IsEditable="false" MinValue="0" MaxValue="1000" />
			<MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="false" MinValue="20" MaxValue="100" />
			<MapAttribute AttributeType="Color" Name="Outline Color" StringValue="#444444" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="ClampedDouble" Name="Outline Width" StringValue="0.3" IsEditable="false" MinValue="0" MaxValue="3" />
			<MapAttribute AttributeType="Boolean" Name="Force Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
			<MapAttribute AttributeType="Boolean" Name="Allow Partial Labels" StringValue="False" IsEditable="false" MinValue="" MaxValue="" />
		  </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Local Roads" DrawOrder="500" MinScaleDenom="0" MaxScaleDenom="24000" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
        <Identify ConnectionKey="{~$ConnectionString.NrcsSpatialMartConnectionString}" GeometryColumn="Shape" SRID="3857" Source="dbo.WSS_ESRI_STREETS_L_UST_2009_WM  with(nolock)">
        <IdentifyAttributes>
				  <LayerIdentifyAttribute ColumnName="DISP_NAME" DisplayName="Name" DisplayEmptyValue="false" />
				</IdentifyAttributes>
			  </Identify>
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Detailed Streets" />
					<LayerDescription Name="Supplier" Value="ESRI, Inc." />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
          LAYER
          NAME '{~@LayerName}'
          STATUS ON
          {~$Projection.3857}
          CONNECTIONTYPE PLUGIN
          PLUGIN '{~$WebConfigSetting.MapServerSqlServerPluginFilename}'
          CONNECTION 'driver={~$WebConfigSetting.SqlServerNativeOdbcDriverName};{~$ConnectionString.NrcsSpatialMartConnectionString}'
          PROCESSING 'CLOSE_CONNECTION=DEFER'
          DATA 'Shape from dbo.WSS_ESRI_STREETS_L_UST_2009_WM   as base_table with(nolock) using unique OBJECTID using SRID=3857'
          composite OPACITY {Opacity} end
          TYPE LINE
          {~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABELITEM 'DISP_NAME'
								}
								CLASS
								STYLE
								COLOR '{Line Color}'
								WIDTH {Line Width}
								OUTLINECOLOR '{Outline Color}'
								OUTLINEWIDTH {Outline Width}
								END
								{~?  {~&amp; {~@AreLabelsVisible} {Show Labels} }
								LABEL
								COLOR '{Label Color}'
								FONT 'arial-bold'
								MINDISTANCE	{Min Distance}
								SIZE {Label Size}
								OUTLINECOLOR '{Label Outline Color}'
								OUTLINEWIDTH {Label Outline Width}
								POSITION AUTO
								FORCE    {Force Labels}
								PARTIALS {Allow Partial Labels}
								TYPE TRUETYPE
								PRIORITY {Label Priority}
								# the line-following label details, all experimental
								BUFFER {Buffer}           # nominal 1/5 inch separation between labels
								REPEATDISTANCE 280  # nominal 4 inch line distance
								ANGLE FOLLOW
								MAXOVERLAPANGLE 22.5
								MINFEATURESIZE auto
								END  #end of label
								}
								END # end of CLASS
								END # end of LAYER '{~@LayerName}'
							</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Local_Roads.png" Text="Local Roads" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupLine>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
	<LegendCategory Name="Background" AreLayerGroupsMutuallyExclusive="false">
	  <MapLayerGroups>
		<MapLayerGroupGeneral Name="Topographic Map" HasLayerDescriptions="true" IsIdentifiable="false" MapLayerGroupId="1018" MapLayerType="General" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="true">
		  <MapAttributes>
			  <MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="true" MinValue="20" MaxValue="100" />
      </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="false" />
			<MapMode Name="Soil Map" VisibleByDefault="false" />
				<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="false" />
				<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="false" />
				<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="false" />
				<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="false" />
				<MapMode Name="Preview" VisibleByDefault="false" />
			<MapMode Name="Report Cover Map" VisibleByDefault="false" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Topo" DrawOrder="4" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="HttpRequest" SkipIfUnavailable="true" AvailablilityTestString="{~$WebConfigSetting.TopoMapServiceBase}{~$WebConfigSetting.TopoMapServicePath}{~$WebConfigSetting.TopoMapServiceDiagnosticQueryString}">
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Topographic Maps" />
					<LayerDescription Name="Supplier" Value="United States Geological Survey" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
					LAYER
					NAME '{~@LayerName}'
					{~$Projection.3857}
					composite OPACITY {Opacity} end
					STATUS ON
					TYPE RASTER
					OFFSITE 0 0 0
					CONNECTIONTYPE WMS
					CONNECTION '{~$WebConfigSetting.TopoMapServiceBase}{~$WebConfigSetting.TopoMapServicePath}?'
					METADATA
					'wms_srs'				'EPSG:3857'
					'wms_name'				'0'
					'wms_server_version'	'1.1.1'
					'wms_format'			'image/jpeg'
					END
					END # end of layer '{~@LayerName}'
				</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Topographic_Map.png" Text="Topographic Map" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupGeneral>
		<MapLayerGroupOrthophoto Name="Aerial Photography" HasLayerDescriptions="true" IsIdentifiable="true" LayerGroupWriterClassName="BingLayerGroupWriter" MapLayerGroupId="1017" MapLayerType="Orthophoto" MinScaleDenom="0" MaxScaleDenom="0" CanUseClientSideImage="true">
		  <MapAttributes>
			  <MapAttribute AttributeType="ClampedInteger" Name="Opacity" StringValue="100" IsEditable="true" MinValue="20" MaxValue="100" />
			  <MapAttribute AttributeType="Boolean" Name="AllowIncompleteTileSet" StringValue="True" IsEditable="false" MinValue="" MaxValue="" />
			  <MapAttribute AttributeType="NameValue" Name="BingLayerComments" StringValue="BingLayerComments placeholder" IsEditable="false" MinValue="" MaxValue="" />
			  <MapAttribute AttributeType="NameValue" Name="BingTileFilenameFQN" StringValue="BingTileFilenameFQN placeholder" IsEditable="false" MinValue="" MaxValue="" />
			  <MapAttribute AttributeType="ClampedInteger" Name="Current Zoom Level" StringValue="1" IsEditable="false" MinValue="1" MaxValue="23" />
      </MapAttributes>
		  <MapModes>
			<MapMode Name="Area of Interest" VisibleByDefault="true" />
			<MapMode Name="Soil Map" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Suitabilities and Limitations for Use" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Properties and Qualities" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Ecological Site Assessment" VisibleByDefault="true" />
						<MapMode Name="Soil Data Explorer:Soil Reports" VisibleByDefault="true" />
						<MapMode Name="Preview" VisibleByDefault="true" />
			<MapMode Name="Report Cover Map" VisibleByDefault="true" />
		  </MapModes>
		  <MapLayers>
			<Layer Name="Orthophotography" DrawOrder="3" MinScaleDenom="0" MaxScaleDenom="0" LabelMinScaleDenom="0" LabelMaxScaleDenom="0" AvailablilityTestType="None" SkipIfUnavailable="false">
			  <MapLayerDescriptionGroups>
				<LayerDescriptionGroup Name="Data Source">
				  <MapLayerDescriptions>
					<LayerDescription Name="Description" Value="Aerial photography and satellite imagery" />
					<LayerDescription Name="Supplier" Value="Microsoft Bing" />
					<LayerDescription Name="Date" Value="Location-specific (use the Identify map tool)" />
				  </MapLayerDescriptions>
				</LayerDescriptionGroup>
			  </MapLayerDescriptionGroups>
			  <MapServerLayerTemplateText>
					LAYER
					NAME '{~@LayerName}'
					{BingLayerComments}
					STATUS ON
					TYPE RASTER
					composite OPACITY {Opacity} end
					{~$Projection.3857}
					PROCESSING 'CLOSE_CONNECTION=NORMAL'
					DATA "{BingTileFilenameFQN}"
					END # end of layer '{~@LayerName}'
				</MapServerLayerTemplateText>
			</Layer>
		  </MapLayers>
		  <MapLegendImage IsDynamic="false">
			<MapLegendImages>
			  <FilenameTextAttributenameComparisonvalueTuple FileName="Aerial_Photography.png" Text="Aerial Photography" />
			</MapLegendImages>
		  </MapLegendImage>
		</MapLayerGroupOrthophoto>
	  </MapLayerGroups>
	  <MapAttributes />
	</LegendCategory>
  </LegendCategories>
</MapConfiguration>